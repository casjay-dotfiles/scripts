#!/usr/bin/env bash
# shellcheck shell=bash
# - - - - - - - - - - - - - - - - - - - - - - - - -
##@Version           :  202602061141-git
# @@Author           :  Jason Hempstead
# @@Contact          :  jason@casjaysdev.pro
# @@License          :  WTFPL
# @@ReadME           :  screen-new --help
# @@Copyright        :  Copyright: (c) 2026 Jason Hempstead, Casjays Developments
# @@Created          :  Friday, Feb 06, 2026 09:24 EST
# @@File             :  screen-new
# @@Description      :  Completions for screen-new session manager
# @@Changelog        :
# @@TODO             :  Better documentation
# @@Other            :
# @@Resource         :
# @@Terminal App     :  no
# @@sudo/root        :  no
# @@Template         :  completions/system
# - - - - - - - - - - - - - - - - - - - - - - - - -
# shellcheck disable=SC1001,SC1003,SC2001,SC2003,SC2016,SC2031,SC2090,SC2115,SC2120,SC2155,SC2199,SC2229,SC2317,SC2329
# - - - - - - - - - - - - - - - - - - - - - - - - -
_screen-new_completion() {
  local cur prev words cword
  _init_completion || return
  cur="${COMP_WORDS[$COMP_CWORD]}"
  prev="${COMP_WORDS[$COMP_CWORD - 1]}"
  local subcmds="a attach ls list kill d detach edit"
  local longopts="--help --version --config --reset --options --debug --raw --dir --silent --force --completions"
  # Helper: get active sn-* session names without the sn- prefix
  __sn_sessions() { screen -ls 2>/dev/null | grep '\.sn-' | sed 's/.*\.sn-//;s/[[:space:]].*//'; }
  if [[ ${cur} == -* ]]; then
    COMPREPLY=($(compgen -W '${longopts}' -- "${cur}"))
    return 0
  fi
  case "${COMP_WORDS[1]}" in
  a | attach)
    # Complete with commands from PATH
    if [ $COMP_CWORD -eq 2 ]; then
      COMPREPLY=($(compgen -c -- "${cur}"))
    fi
    return 0
    ;;
  kill)
    if [ $COMP_CWORD -eq 2 ]; then
      local sessions="$(__sn_sessions) all"
      COMPREPLY=($(compgen -W '${sessions}' -- "${cur}"))
    fi
    return 0
    ;;
  d | detach)
    if [ $COMP_CWORD -eq 2 ]; then
      local sessions="$(__sn_sessions)"
      COMPREPLY=($(compgen -W '${sessions}' -- "${cur}"))
    fi
    return 0
    ;;
  ls | list)
    return 0
    ;;
  edit)
    if [ $COMP_CWORD -eq 2 ]; then
      local sessions="$(__sn_sessions)"
      COMPREPLY=($(compgen -W '${sessions}' -- "${cur}"))
    fi
    return 0
    ;;
  --completions)
    if [ $COMP_CWORD -eq 2 ]; then
      COMPREPLY=($(compgen -W 'long short list array' -- "${cur}"))
    fi
    return 0
    ;;
  --debug | --raw)
    COMPREPLY=($(compgen -W '${subcmds}' -- "${cur}"))
    return 0
    ;;
  --help | --version | --config | --reset | --options)
    return 0
    ;;
  esac
  # Default: complete with subcommands, commands from PATH, and directories
  if [ $COMP_CWORD -eq 1 ]; then
    COMPREPLY=($(compgen -W '${subcmds} ${longopts}' -- "${cur}") $(compgen -c -- "${cur}") $(compgen -d -- "${cur}"))
    COMPREPLY=($(printf '%s\n' "${COMPREPLY[@]}" | sort -u))
  fi
} &&
  complete -F _screen-new_completion -o default screen-new

# ex: ts=2 sw=2 et filetype=sh
