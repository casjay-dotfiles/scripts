.TH DMENURECORD "1" "December 2025" "dmenurecord 202208052145-git" "User Commands"
.SH NAME
dmenurecord \- Interactive screen, audio, and video recording tool with dmenu/rofi interface
.SH SYNOPSIS
.B dmenurecord
[\fI\,OPTIONS\/\fR] [\fI\,COMMAND\/\fR]
.SH DESCRIPTION
.B dmenurecord
is an interactive recording tool that provides a dmenu/rofi interface for selecting and starting screen recordings, screencasts, webcam recordings, and audio recordings. It uses ffmpeg for recording with optimized codecs and settings for different recording types.
.PP
The script manages recording processes through PID files, integrates with status bars for visual feedback, and provides desktop notifications for recording state changes. It supports both interactive menu-driven recording and direct command-line recording modes.
.PP
dmenurecord simplifies the complexity of ffmpeg commands by providing preconfigured recording profiles optimized for different use cases, making high-quality screen and audio recording accessible through a simple menu interface.
.SH COMMANDS
.TP
.B dmenurecord
Launch interactive menu to select recording type (default action if no recording active)
.TP
.B dmenurecord screencast
Start screencast (screen + audio) recording with high quality settings
.TP
.B dmenurecord video
Start video-only (screen without audio) recording
.TP
.B dmenurecord audio
Start audio-only recording with FLAC codec
.TP
.B dmenurecord stop
Stop active recording gracefully (also: kill)
.SH OPTIONS
.TP
.BR \-\-help
Display help message with available commands and usage examples
.TP
.BR \-\-config
Generate or regenerate user configuration file with default settings
.TP
.BR \-\-version
Show script version information and exit
.TP
.BR \-\-options
Display all available command-line options and commands
.TP
.BR \-\-debug
Enable debug mode with verbose output and command tracing (set -x)
.TP
.BR \-\-raw
Disable colorized output for plain text display
.TP
.BR \-\-silent
Suppress non-essential output messages and notifications
.SH USAGE
.B dmenurecord
.PP
Launch dmenu/rofi menu to select recording type:
.RS
.IP \(bu 2
screencast - Record screen and audio
.IP \(bu 2
video - Record screen only
.IP \(bu 2
audio - Record audio only
.IP \(bu 2
webcam - Record webcam (640x480)
.IP \(bu 2
webcam (hi-def) - Record webcam (1920x1080)
.RE
.PP
If a recording is already active, menu will prompt to end recording instead.
.SH RECORDING MODES
.SS Screencast Mode
Records both screen and audio simultaneously:
.RS
.IP \(bu 2
Video: x11grab at 60fps with x264rgb codec (CRF 0, ultrafast preset)
.IP \(bu 2
Audio: ALSA default input with FLAC codec (lossless)
.IP \(bu 2
Output: 30fps video with synchronized audio
.IP \(bu 2
Quality: Lossless video, lossless audio
.IP \(bu 2
Use case: Tutorials, demonstrations, gameplay recording
.RE
.PP
.B FFmpeg Command:
.RS
.EX
ffmpeg -y -f x11grab -framerate 60 \\
  -s $(xdpyinfo | grep dimensions | awk '{print $2;}') \\
  -i $DISPLAY -f alsa -i default -r 30 \\
  -c:v libx264rgb -crf 0 -preset ultrafast \\
  -c:a flac "$filename.mkv"
.EE
.RE
.SS Video Mode
Records screen only without audio:
.RS
.IP \(bu 2
Video: x11grab with x264 codec (QP 0 for lossless)
.IP \(bu 2
Frame rate: 30fps
.IP \(bu 2
Resolution: Automatic (detects current display resolution)
.IP \(bu 2
Quality: Lossless video
.IP \(bu 2
Use case: Screen demonstrations, silent tutorials, window recordings
.RE
.PP
.B FFmpeg Command:
.RS
.EX
ffmpeg -f x11grab \\
  -s $(xdpyinfo | grep dimensions | awk '{print $2;}') \\
  -i $DISPLAY -c:v libx264 -qp 0 -r 30 "$filename.mkv"
.EE
.RE
.SS Audio Mode
Records audio only:
.RS
.IP \(bu 2
Audio: ALSA default input
.IP \(bu 2
Codec: FLAC (lossless compression)
.IP \(bu 2
Quality: Lossless audio
.IP \(bu 2
Use case: Voice recording, podcasts, audio notes, music recording
.RE
.PP
.B FFmpeg Command:
.RS
.EX
ffmpeg -f alsa -i default -c:a flac "$filename.flac"
.EE
.RE
.SS Webcam Mode (Standard Definition)
Records webcam at standard resolution:
.RS
.IP \(bu 2
Input: /dev/video0 via v4l2
.IP \(bu 2
Resolution: 640x480
.IP \(bu 2
Use case: Video calls recording, basic video notes
.RE
.PP
.B FFmpeg Command:
.RS
.EX
ffmpeg -f v4l2 -i /dev/video0 \\
  -video_size 640x480 "$filename.mkv"
.EE
.RE
.SS Webcam Mode (High Definition)
Records webcam at high resolution:
.RS
.IP \(bu 2
Input: /dev/video0 via v4l2
.IP \(bu 2
Resolution: 1920x1080
.IP \(bu 2
Use case: High-quality video recording, streaming preparation
.RE
.PP
.B FFmpeg Command:
.RS
.EX
ffmpeg -f v4l2 -i /dev/video0 \\
  -video_size 1920x1080 "$filename.mkv"
.EE
.RE
.SH FILES
.TP
.B ~/.config/myscripts/dmenurecord/settings.conf
User configuration file for dmenurecord preferences
.TP
.B ~/.config/myscripts/dmenurecord/backups/
Configuration backup directory
.TP
.B ~/.local/log/dmenurecord/
Log file directory for error tracking
.TP
.B ~/.local/tmp/system_scripts/dmenurecord/
Temporary files directory
.TP
.B ~/.local/tmp/system_scripts/dmenurecord/recordingpid
PID file for active recording process
.TP
.B ~/.cache/dmenurecord/
Cache directory
.TP
.B ~/Videos/Recordings/
Default directory for saved recordings (configurable)
.SH ENVIRONMENT VARIABLES
.TP
.B DMENURECORD_CONFIG_DIR
Override default configuration directory (~/.config/myscripts/dmenurecord/)
.TP
.B DMENURECORD_SAVE_DIR
Directory for saving recordings (default: ~/Videos/Recordings/)
.TP
.B DMENURECORD_EXT
File extension for recordings (default: .mkv)
.TP
.B DMENURECORD_DATE_FMT
Date format for recording filenames (default: %y%m%d-%H%M-%S)
.TP
.B DMENURECORD_PID_FILE
Location of PID file for tracking active recording
.TP
.B DMENURECORD_OUTPUT_COLOR_1
Primary output color code for terminal display (default: 33 for yellow)
.TP
.B DMENURECORD_OUTPUT_COLOR_2
Secondary output color code (default: 5 for magenta)
.TP
.B DMENURECORD_OUTPUT_COLOR_GOOD
Success message color code (default: 2 for green)
.TP
.B DMENURECORD_OUTPUT_COLOR_ERROR
Error message color code (default: 1 for red)
.TP
.B DMENURECORD_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.TP
.B DMENURECORD_NOTIFY_CLIENT_NAME
Customize notification client name displayed in desktop notifications
.TP
.B DMENURECORD_NOTIFY_CLIENT_ICON
Customize notification icon (default: notification-new)
.TP
.B DMENURECORD_NOTIFY_CLIENT_URGENCY
Notification urgency level: low, normal, critical (default: normal)
.SH CONFIGURATION FILE
The configuration file located at ~/.config/myscripts/dmenurecord/settings.conf supports the following settings:
.PP
.RS 4
.EX
DMENURECORD_SAVE_DIR="$HOME/Videos/Recordings"
DMENURECORD_EXT=".mkv"
DMENURECORD_DATE_FMT="%y%m%d-%H%M-%S"
DMENURECORD_NOTIFY_ENABLED="yes"
.EE
.RE
.SH EXIT STATUS
.TP
.B 0
Success - recording started or stopped successfully
.TP
.B 1
General error or user cancelled operation
.SH EXAMPLES
.TP
.B dmenurecord
Launch interactive menu to select recording type
.TP
.B dmenurecord screencast
Start screencast recording (screen + audio) immediately
.TP
.B dmenurecord video
Start video-only recording immediately
.TP
.B dmenurecord audio
Start audio-only recording immediately
.TP
.B dmenurecord stop
Stop active recording
.TP
.B DMENURECORD_SAVE_DIR=/tmp/recordings dmenurecord
Launch menu with custom save directory
.SH RECORDING WORKFLOW
.SS Starting a Recording
.RS
.IP 1. 3
Run dmenurecord (menu appears)
.IP 2. 3
Select recording type from menu
.IP 3. 3
Recording starts immediately in background
.IP 4. 3
Desktop notification confirms recording started
.IP 5. 3
Status bar icon updates (if configured)
.IP 6. 3
PID file created for process tracking
.RE
.SS Stopping a Recording
.RS
.IP 1. 3
Run dmenurecord while recording active
.IP 2. 3
Menu prompts to end recording
.IP 3. 3
Recording process receives SIGTERM (graceful stop)
.IP 4. 3
After 3 seconds, SIGKILL sent if still running
.IP 5. 3
Desktop notification confirms recording stopped
.IP 6. 3
Status bar icon updated
.IP 7. 3
File saved to configured directory
.RE
.SH RECORDING MANAGEMENT
.SS PID File Tracking
dmenurecord uses a PID file to track active recordings:
.RS
.IP \(bu 2
Location: ~/.local/tmp/system_scripts/dmenurecord/recordingpid
.IP \(bu 2
Contains process ID of active ffmpeg process
.IP \(bu 2
Checked before starting new recording
.IP \(bu 2
Removed automatically when recording stops
.IP \(bu 2
Prevents multiple simultaneous recordings
.RE
.SS Stop Recording Process
Recording termination uses graceful shutdown:
.RS
.IP 1. 3
Send SIGTERM (15) to recording process
.IP 2. 3
Wait 3 seconds for process to finish encoding
.IP 3. 3
Send SIGKILL (9) if process still running
.IP 4. 3
Ensures file is properly finalized
.RE
.SH FILENAME FORMAT
Recordings are saved with timestamp-based filenames:
.PP
.B Format:
.RS
[type]-[date].[ext]
.RE
.PP
.B Examples:
.RS
.IP \(bu 2
screencast-241209-143022.mkv
.IP \(bu 2
video-241209-143522.mkv
.IP \(bu 2
audio-241209-144022.flac
.IP \(bu 2
webcam-241209-144522.mkv
.IP \(bu 2
webcam-hi-241209-145022.mkv
.RE
.PP
Date format controlled by DMENURECORD_DATE_FMT (%y%m%d-%H%M-%S by default).
.SH STATUS BAR INTEGRATION
dmenurecord includes status bar update function for visual feedback:
.PP
.B updateicon() function:
.RS
.IP \(bu 2
Updates status bar when recording state changes
.IP \(bu 2
Shows recording indicator icon
.IP \(bu 2
Integrates with dwmblocks, polybar, i3blocks, etc.
.IP \(bu 2
Optional feature - not required for basic operation
.RE
.PP
Status bar integration requires custom configuration in your bar config.
.SH MENU INTERFACE
dmenurecord uses either rofi or dmenu for the interactive menu interface:
.PP
.B Menu Tool Priority:
.RS
.IP 1. 3
rofi (preferred) - Modern menu with theme support, icons, fuzzy search
.IP 2. 3
dmenu - Lightweight, fast, minimal interface
.RE
.PP
The menu will automatically use whichever tool is available, preferring rofi for enhanced features.
.PP
.B Menu Navigation:
.RS
.IP \(bu 2
Use arrow keys or type to filter options
.IP \(bu 2
Press Enter to select highlighted option
.IP \(bu 2
Press Escape to cancel operation
.IP \(bu 2
rofi supports fuzzy search for quick filtering
.RE
.SH USE CASES
.SS Tutorial Recording
.RS
.IP 1. 3
Run dmenurecord
.IP 2. 3
Select "screencast" for screen + audio
.IP 3. 3
Perform tutorial demonstration
.IP 4. 3
Run dmenurecord and confirm end recording
.IP 5. 3
Video saved to ~/Videos/Recordings/
.RE
.SS Silent Screen Recording
.RS
.IP 1. 3
Run dmenurecord video
.IP 2. 3
Record screen without audio
.IP 3. 3
Stop with dmenurecord stop
.RE
.SS Podcast Audio Recording
.RS
.IP 1. 3
Run dmenurecord audio
.IP 2. 3
Record podcast episode with FLAC quality
.IP 3. 3
Stop recording when complete
.IP 4. 3
FLAC file ready for editing
.RE
.SS Webcam Video Note
.RS
.IP 1. 3
Run dmenurecord
.IP 2. 3
Select "webcam (hi-def)" for 1080p
.IP 3. 3
Record video message or note
.IP 4. 3
Stop recording
.RE
.SH NOTES
.IP \(bu 2
Requires X11 window system for screen recording
.IP \(bu 2
Only one recording can be active at a time
.IP \(bu 2
Recording runs in background, terminal can be closed
.IP \(bu 2
PID file prevents multiple simultaneous recordings
.IP \(bu 2
Desktop notifications require notification daemon
.IP \(bu 2
Screencast uses lossless codecs (large files)
.IP \(bu 2
Audio recorded from ALSA default input
.IP \(bu 2
Webcam requires /dev/video0 device
.IP \(bu 2
Recording directory created automatically if missing
.IP \(bu 2
Files use timestamp-based naming to prevent overwrites
.SH CODEC DETAILS
.SS x264rgb (Screencast Video)
.RS
.IP \(bu 2
Lossless RGB encoding
.IP \(bu 2
CRF 0 (constant rate factor 0 = lossless)
.IP \(bu 2
Ultrafast preset (minimal CPU encoding time)
.IP \(bu 2
Ideal for screen content with sharp text and UI elements
.IP \(bu 2
Large file sizes (2-10 GB per hour typical)
.RE
.SS x264 (Video Mode)
.RS
.IP \(bu 2
Lossless YUV420 encoding
.IP \(bu 2
QP 0 (quantization parameter 0 = lossless)
.IP \(bu 2
Standard x264 codec
.IP \(bu 2
Slightly better compression than x264rgb
.RE
.SS FLAC (Audio)
.RS
.IP \(bu 2
Free Lossless Audio Codec
.IP \(bu 2
Typically 30-70% original audio size
.IP \(bu 2
Perfect audio quality preservation
.IP \(bu 2
Open source, widely supported
.RE
.SH TROUBLESHOOTING
.SS Recording Not Starting
.RS
.IP \(bu 2
Check if ffmpeg is installed: which ffmpeg
.IP \(bu 2
Verify display available: echo $DISPLAY
.IP \(bu 2
Check PID file for stale recording: cat ~/.local/tmp/system_scripts/dmenurecord/recordingpid
.IP \(bu 2
Remove stale PID file if process not running
.RE
.SS No Audio in Screencast
.RS
.IP \(bu 2
Check ALSA configuration: arecord -L
.IP \(bu 2
Test audio input: arecord -d 5 test.wav
.IP \(bu 2
Verify microphone not muted in mixer
.IP \(bu 2
Check audio device selection in ALSA settings
.RE
.SS Webcam Not Working
.RS
.IP \(bu 2
Check device exists: ls -l /dev/video0
.IP \(bu 2
Verify not in use by other application
.IP \(bu 2
Test with v4l2-ctl: v4l2-ctl --list-devices
.IP \(bu 2
Check permissions: groups (should include 'video')
.RE
.SS Large File Sizes
.RS
.IP \(bu 2
Lossless codecs create large files (expected)
.IP \(bu 2
Use video mode instead of screencast if no audio needed
.IP \(bu 2
Post-process with lossy compression if needed
.IP \(bu 2
Example: ffmpeg -i input.mkv -c:v libx264 -crf 23 output.mp4
.RE
.SS Menu Not Appearing
.RS
.IP \(bu 2
Install rofi: sudo apt install rofi or sudo pacman -S rofi
.IP \(bu 2
Install dmenu: sudo apt install dmenu or sudo pacman -S dmenu
.IP \(bu 2
Check if running in X11 session (not Wayland)
.IP \(bu 2
Verify DISPLAY environment variable is set
.RE
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \(bu 2
bash - Bash shell for script execution
.IP \(bu 2
ffmpeg - Audio/video recording and encoding
.IP \(bu 2
xdpyinfo - X11 display information utility (x11-utils)
.IP \(bu 2
rofi OR dmenu - Menu interface (at least one required)
.RE
.TP
.B Optional:
.RS
.IP \(bu 2
v4l2 - Video4Linux2 for webcam recording (linux-utils)
.IP \(bu 2
ALSA - Audio recording support (alsa-utils)
.IP \(bu 2
notify-send - Desktop notifications (libnotify)
.IP \(bu 2
Status bar - For recording indicator integration
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \(co 2022 Jason Hempstead, Casjays Developments
.br
License: WTFPL (Do What The F*** You Want To Public License)
.SH SEE ALSO
.BR ffmpeg (1),
.BR rofi (1),
.BR dmenu (1),
.BR xdpyinfo (1),
.BR arecord (1),
.BR v4l2-ctl (1)
.PP
FFmpeg Documentation: https://ffmpeg.org/documentation.html
.PP
Related tools:
.br
SimpleScreenRecorder: https://www.maartenbaert.be/simplescreenrecorder/
.br
OBS Studio: https://obsproject.com/
.br
recordMyDesktop: http://recordmydesktop.sourceforge.net/
