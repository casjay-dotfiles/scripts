.TH DOS2UNIX "1" "December 2025" "dos2unix 202208052222-git" "User Commands"
.SH NAME
dos2unix \- Convert DOS/Windows line endings to Unix line endings
.SH SYNOPSIS
.B dos2unix
[\fI\,OPTIONS\/\fR] [\fI\,FILE\/\fR|\fI\,DIRECTORY\/\fR...]
.SH DESCRIPTION
.B dos2unix
is a line ending conversion utility that finds and converts files with DOS/Windows line endings (CRLF: \\r\\n) to Unix line endings (LF: \\n). It can process individual files or recursively scan directories for ASCII text files.
.PP
The script automatically detects ASCII text files, excludes version control and dependency directories (.git, node_modules, .npm), and performs in-place conversion using multiple sed patterns to handle different line ending formats.
.PP
dos2unix simplifies cross-platform text file compatibility by ensuring consistent Unix line endings, preventing issues with scripts, configuration files, and source code that originated on Windows systems.
.SH COMMANDS
.TP
.B dos2unix file.txt
Convert single file from DOS to Unix line endings
.TP
.B dos2unix file1.txt file2.txt file3.txt
Convert multiple files
.TP
.B dos2unix /path/to/directory
Convert all ASCII files in directory (non-recursive, maxdepth 1)
.TP
.B dos2unix dir1/ dir2/ file.txt
Convert files in multiple directories and specific files
.SH OPTIONS
.TP
.BR \-\-help
Display help message with usage information
.TP
.BR \-\-config
Generate or regenerate user configuration file with default settings
.TP
.BR \-\-version
Show script version information and exit
.TP
.BR \-\-options
Display all available command-line options
.TP
.BR \-\-debug
Enable debug mode with verbose output and command tracing (set -x)
.TP
.BR \-\-raw
Disable colorized output for plain text display
.TP
.BR \-\-silent
Suppress non-essential output messages
.TP
.BR \-\-dir " " \fI\,DIRECTORY\/\fR
Set working directory for file search (not commonly used)
.TP
.BR \-\-force
Force conversion (reserved for future use)
.SH USAGE
.B dos2unix file.txt
.PP
Converts file.txt from DOS line endings to Unix line endings in-place.
.PP
.B dos2unix *.sh
.PP
Converts all shell scripts in current directory.
.PP
.B dos2unix /path/to/project
.PP
Converts all ASCII files in /path/to/project directory.
.SH FILE DETECTION
The script uses intelligent file detection to find convertible files:
.SS ASCII File Detection
.RS
.IP \(bu 2
Uses file command to identify ASCII text files
.IP \(bu 2
Processes only text files (skips binary files)
.IP \(bu 2
Follows symbolic links
.IP \(bu 2
Real path resolution for accurate file identification
.RE
.SS Directory Handling
.RS
.IP \(bu 2
Non-recursive by default (maxdepth 1)
.IP \(bu 2
Excludes .git directories
.IP \(bu 2
Excludes node_modules directories
.IP \(bu 2
Excludes .npm directories
.IP \(bu 2
Processes files and links only (type f,l)
.RE
.PP
.B File detection command:
.RS
.EX
find "$directory" -maxdepth 1 -type f,l \\
  -not -path "*/.git/*" \\
  -not -path "*/node_modules/*" \\
  -not -path "*/.npm/*" \\
  -exec file {} \\; | grep 'ASCII' | cut -d: -f1
.EE
.RE
.SH CONVERSION PROCESS
Line ending conversion uses three sed patterns for comprehensive coverage:
.SS Sed Pattern 1: Carriage Return Removal
.RS
.EX
sed -i 's|$||' file
.EE
Removes trailing carriage returns (\\r) at end of lines
.RE
.SS Sed Pattern 2: Literal ^M Removal
.RS
.EX
sed -i 's|^M$||' file
.EE
Removes literal ^M characters at end of lines (Ctrl+V Ctrl+M in editors)
.RE
.SS Sed Pattern 3: Hex 0x0D Removal
.RS
.EX
sed -i 's|\\x0D$||' file
.EE
Removes hex 0x0D (carriage return) at end of lines
.RE
.PP
All conversions are performed in-place, modifying files directly without creating backups.
.SH EXAMPLES
.TP
.B dos2unix script.sh
Convert shell script to Unix line endings
.TP
.B dos2unix *.txt
Convert all .txt files in current directory
.TP
.B dos2unix config.conf Makefile README
Convert specific files
.TP
.B dos2unix /opt/project
Convert all ASCII files in /opt/project directory
.TP
.B dos2unix src/ docs/ README.md
Convert files in src/ and docs/ directories plus README.md
.TP
.B find . -name "*.sh" -exec dos2unix {} \\;
Recursively convert all shell scripts (using find)
.SH FILES
.TP
.B ~/.config/myscripts/dos2unix/settings.conf
User configuration file for dos2unix preferences
.TP
.B ~/.local/share/myscripts/dos2unix/backups/
Configuration backup directory
.TP
.B ~/.local/log/dos2unix/
Log file directory for error tracking
.TP
.B ~/.local/tmp/system_scripts/dos2unix/
Temporary files directory
.TP
.B ~/.cache/dos2unix/
Cache directory
.SH ENVIRONMENT VARIABLES
.TP
.B DOS2UNIX_CONFIG_DIR
Override default configuration directory (~/.config/myscripts/dos2unix/)
.TP
.B DOS2UNIX_FORCE
Force conversion mode (default: 0)
.TP
.B DOS2UNIX_OUTPUT_COLOR_1
Primary output color code for terminal display (default: 33 for yellow)
.TP
.B DOS2UNIX_OUTPUT_COLOR_2
Secondary output color code (default: 5 for magenta)
.TP
.B DOS2UNIX_OUTPUT_COLOR_GOOD
Success message color code (default: 2 for green)
.TP
.B DOS2UNIX_OUTPUT_COLOR_ERROR
Error message color code (default: 1 for red)
.TP
.B DOS2UNIX_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.TP
.B DOS2UNIX_NOTIFY_CLIENT_NAME
Customize notification client name displayed in desktop notifications
.TP
.B DOS2UNIX_NOTIFY_CLIENT_ICON
Customize notification icon (default: notification-new)
.TP
.B DOS2UNIX_NOTIFY_CLIENT_URGENCY
Notification urgency level: low, normal, critical (default: normal)
.SH CONFIGURATION FILE
The configuration file located at ~/.config/myscripts/dos2unix/settings.conf supports the following settings:
.PP
.RS 4
.EX
DOS2UNIX_NOTIFY_ENABLED="yes"
.EE
.RE
.SH EXIT STATUS
.TP
.B 0
Success - all files converted successfully
.TP
.B 1
Error converting one or more files
.TP
.B 2
File does not exist
.SH LINE ENDING TYPES
.SS DOS/Windows Line Endings (CRLF)
.RS
.IP \(bu 2
Format: Carriage Return + Line Feed (\\r\\n)
.IP \(bu 2
Hex: 0x0D 0x0A
.IP \(bu 2
Used by: Windows, DOS
.IP \(bu 2
Shows as ^M$ in some editors
.RE
.SS Unix/Linux Line Endings (LF)
.RS
.IP \(bu 2
Format: Line Feed only (\\n)
.IP \(bu 2
Hex: 0x0A
.IP \(bu 2
Used by: Linux, Unix, macOS
.IP \(bu 2
Standard for shell scripts and configuration files
.RE
.SS Classic Mac Line Endings (CR)
.RS
.IP \(bu 2
Format: Carriage Return only (\\r)
.IP \(bu 2
Hex: 0x0D
.IP \(bu 2
Used by: Classic Mac OS (pre-OS X)
.IP \(bu 2
Rarely encountered today (macOS uses Unix LF)
.RE
.SH COMMON ISSUES
.SS Script Not Executable
Files with DOS line endings may fail to execute as scripts:
.RS
.EX
./script.sh: /bin/bash^M: bad interpreter
.EE
Solution: Run dos2unix on the script file
.RE
.SS Git Diff Noise
DOS line endings cause every line to show as modified in git:
.RS
.EX
warning: LF will be replaced by CRLF
.EE
Solution: Convert files with dos2unix, configure .gitattributes
.RE
.SS Editor Display Issues
Some editors show ^M at end of every line:
.RS
.IP \(bu 2
Indicates DOS line endings present
.IP \(bu 2
Can interfere with text processing
.IP \(bu 2
May break configuration parsing
.RE
.SH USE CASES
.SS After Cloning Windows Repository
.RS
.IP 1. 3
Clone repository from Windows developer
.IP 2. 3
Notice ^M characters or script execution failures
.IP 3. 3
Run dos2unix on affected files
.IP 4. 3
Scripts execute correctly
.IP 5. 3
Commit with Unix line endings
.RE
.SS Before Git Commit
.RS
.IP 1. 3
Download files from web or email (Windows source)
.IP 2. 3
Add to git repository
.IP 3. 3
Git warns about line ending conversion
.IP 4. 3
Run dos2unix on new files
.IP 5. 3
Commit with consistent Unix line endings
.RE
.SS Fixing Shell Scripts
.RS
.IP 1. 3
Shell script fails with "bad interpreter" error
.IP 2. 3
Identify DOS line endings with: file script.sh
.IP 3. 3
Run dos2unix script.sh
.IP 4. 3
Script executes successfully
.RE
.SS Batch Conversion
.RS
.IP 1. 3
Import project from Windows environment
.IP 2. 3
Multiple files have DOS line endings
.IP 3. 3
Run dos2unix /path/to/project
.IP 4. 3
All ASCII files converted to Unix format
.IP 5. 3
Project works correctly on Unix systems
.RE
.SH GIT INTEGRATION
.SS Prevent Line Ending Issues
Configure .gitattributes to enforce Unix line endings:
.RS
.EX
# .gitattributes
* text=auto eol=lf
*.sh text eol=lf
*.conf text eol=lf
.EE
.RE
.SS Pre-commit Hook
Automatically convert files before commit:
.RS
.EX
#!/bin/bash
# .git/hooks/pre-commit
git diff --cached --name-only --diff-filter=ACM | \\
  while read file; do
    dos2unix "$file"
    git add "$file"
  done
.EE
.RE
.SH NOTES
.IP \(bu 2
Conversion is performed in-place (no backup created)
.IP \(bu 2
Only processes ASCII text files (skips binary files)
.IP \(bu 2
Excludes version control directories (.git)
.IP \(bu 2
Excludes dependency directories (node_modules, .npm)
.IP \(bu 2
Directory processing is non-recursive (maxdepth 1)
.IP \(bu 2
Multiple sed patterns ensure comprehensive conversion
.IP \(bu 2
File command used to identify text files
.IP \(bu 2
Works on files and symbolic links
.IP \(bu 2
Real path resolution for accurate file handling
.IP \(bu 2
No backup files created (original overwritten)
.SH TIPS
.SS Detect Line Endings
Check file line ending type before conversion:
.RS
.EX
file filename.txt
# Output: ASCII text, with CRLF line terminators (DOS)
# Output: ASCII text (Unix)
.EE
.RE
.SS Manual Inspection
View line endings in hex:
.RS
.EX
od -c filename.txt | head
hexdump -C filename.txt | head
.EE
.RE
.SS Vim Detection
In vim, check file format:
.RS
.EX
:set fileformat?
# Shows: fileformat=dos or fileformat=unix
.EE
.RE
.SS Recursive Conversion
For recursive directory processing:
.RS
.EX
# Option 1: Using find
find /path/to/dir -type f -name "*.txt" \\
  -exec dos2unix {} \\;

# Option 2: Process each directory manually
for dir in */; do dos2unix "$dir"; done
.EE
.RE
.SH TROUBLESHOOTING
.SS Binary File Warning
.RS
.IP \(bu 2
Script only processes ASCII text files
.IP \(bu 2
Binary files automatically skipped
.IP \(bu 2
Use file command to verify file type
.IP \(bu 2
No error generated for binary files
.RE
.SS No Files Found
.RS
.IP \(bu 2
Verify directory path is correct
.IP \(bu 2
Check if directory contains ASCII files
.IP \(bu 2
Use file * to see file types
.IP \(bu 2
Remember processing is non-recursive
.RE
.SS Permission Denied
.RS
.IP \(bu 2
Ensure you have write permission for files
.IP \(bu 2
Check file ownership and permissions
.IP \(bu 2
Use ls -l to verify permissions
.IP \(bu 2
May need sudo for system files
.RE
.SH ALTERNATIVES
Other tools for line ending conversion:
.RS
.IP \(bu 2
dos2unix (standard package) - Similar functionality
.IP \(bu 2
unix2dos - Reverse conversion (Unix to DOS)
.IP \(bu 2
tr -d '\\r' - Simple carriage return deletion
.IP \(bu 2
sed 's/\\r$//' - Manual sed conversion
.IP \(bu 2
perl -pi -e 's/\\r\\n/\\n/' - Perl one-liner
.IP \(bu 2
fromdos/todos - Alternative commands (tofrodos package)
.RE
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \(bu 2
bash - Bash shell for script execution
.IP \(bu 2
sed - Stream editor for text transformation
.IP \(bu 2
find - Find files in directory tree
.IP \(bu 2
file - Determine file type
.IP \(bu 2
grep - Text pattern matching
.IP \(bu 2
realpath - Resolve file paths
.RE
.TP
.B Optional:
.RS
.IP \(bu 2
dos2unix package - System dos2unix command (not required)
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \(co 2022 Jason Hempstead, Casjays Developments
.br
License: WTFPL (Do What The F*** You Want To Public License)
.SH SEE ALSO
.BR sed (1),
.BR find (1),
.BR file (1),
.BR unix2dos (1),
.BR fromdos (1),
.BR todos (1)
.PP
Related documentation:
.br
Line ending Wikipedia: https://en.wikipedia.org/wiki/Newline
.br
Git line endings: https://git-scm.com/docs/gitattributes#_end_of_line_conversion
