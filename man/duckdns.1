.TH DUCKDNS "1" "December 2025" "duckdns 202501191000-git" "User Commands"
.SH NAME
duckdns \- DuckDNS dynamic DNS API client with Let's Encrypt SSL certificate management
.SH SYNOPSIS
.B duckdns
[\fI\,COMMAND\/\fR] [\fI\,DOMAIN\/\fR] [\fI\,IPv4\/\fR] [\fI\,IPv6\/\fR]
.SH DESCRIPTION
.B duckdns
is a command-line client for the DuckDNS dynamic DNS service (https://www.duckdns.org). It provides automated IP address updates for DuckDNS domains and integrates with Let's Encrypt for SSL certificate generation and renewal using Docker-based certbot.
.PP
DuckDNS is a free dynamic DNS service that allows users to point a subdomain under duckdns.org to their dynamic IP address. This script automates the process of keeping DNS records updated and managing SSL certificates for secure HTTPS connections.
.PP
duckdns simplifies dynamic DNS management by providing automatic IP detection (IPv4 and IPv6), TXT record support, cron job setup for scheduled updates, and complete Let's Encrypt certificate lifecycle management.
.SH COMMANDS
.TP
.B duckdns update [domain] [ipv4] [ipv6]
Update DuckDNS record with specified or auto-detected IP addresses
.TP
.B duckdns ssl create [domain]
Create Let's Encrypt SSL certificates for domain and wildcard subdomain
.TP
.B duckdns ssl renew [domain]
Renew existing Let's Encrypt SSL certificates
.TP
.B duckdns ssl cron [domain]
Setup cron job for SSL certificate renewal
.TP
.B duckdns cron install [domain]
Install cron jobs for DNS updates and SSL renewal
.TP
.B duckdns cron remove [domain]
Remove cron job for specified domain
.TP
.B duckdns cron run [domain]
Manually run cron job for domain (silent mode)
.TP
.B duckdns info
Display current configuration and environment variables
.SH OPTIONS
.TP
.BR \-\-help
Display help message with usage information
.TP
.BR \-\-config
Generate or regenerate user configuration file with default settings
.TP
.BR \-\-version
Show script version information and exit
.TP
.BR \-\-options
Display all available command-line options
.TP
.BR \-\-debug
Enable debug mode with verbose output and command tracing (set -x)
.TP
.BR \-\-raw
Disable colorized output for plain text display
.SH USAGE
.B duckdns update example.duckdns.org
.PP
Updates DNS record for example.duckdns.org with auto-detected public IP.
.PP
.B duckdns update example yes
.PP
Updates with auto-detected IPv4 (specify 'yes' or 'true' to auto-detect).
.PP
.B duckdns update example 1.2.3.4 2001:db8::1
.PP
Updates with specific IPv4 and IPv6 addresses.
.PP
.B duckdns ssl create example.duckdns.org
.PP
Creates Let's Encrypt certificates for example.duckdns.org and *.example.duckdns.org.
.PP
.B duckdns cron install example.duckdns.org
.PP
Installs cron jobs for automatic updates (every 5 minutes) and SSL renewal (every 8 days).
.SH DNS UPDATE
The update command sends DNS record changes to DuckDNS API:
.SS IP Address Detection
.RS
.IP \(bu 2
Auto-detection: Use 'yes' or 'true' as IP argument
.IP \(bu 2
IPv4 detection: Queries https://ifcfg.us using curl -4
.IP \(bu 2
IPv6 detection: Queries https://ifcfg.us using curl -6
.IP \(bu 2
Manual specification: Provide exact IP address
.IP \(bu 2
Validation: IPv4 and IPv6 addresses validated with regex
.RE
.SS Update Process
.RS
.IP 1. 3
Domain validation and normalization (add .duckdns.org if needed)
.IP 2. 3
IP address resolution (auto-detect or use provided values)
.IP 3. 3
API call to DuckDNS with domain, token, and IP addresses
.IP 4. 3
Response parsing for success/failure and changed IPs
.IP 5. 3
Result display with detailed status messages
.RE
.SS API Request Format
.RS
.EX
https://www.duckdns.org/update/?domains={domain}
  &token={api_key}
  &ip={ipv4}
  &ipv6={ipv6}
  &clear={clear}
  &verbose=true
.EE
.RE
.SS Response Handling
.RS
.IP \(bu 2
Success (OK): Display updated IP addresses
.IP \(bu 2
No change (NOCHANGE): Indicate record unchanged
.IP \(bu 2
Failure: Show error message from API
.IP \(bu 2
IPv4/IPv6: Extract and validate changed addresses
.RE
.SH SSL CERTIFICATE MANAGEMENT
Let's Encrypt SSL certificate creation and renewal using Docker certbot:
.SS Certificate Creation
.RS
.IP 1. 3
Pulls infinityofspace/certbot_dns_duckdns:latest Docker image
.IP 2. 3
Creates /etc/letsencrypt and /var/log/letsencrypt directories
.IP 3. 3
Runs certbot with DNS challenge authentication
.IP 4. 3
Generates certificates for domain and wildcard (*.domain)
.IP 5. 3
Saves certificates to /etc/letsencrypt/live/{domain}/
.IP 6. 3
Automatically sets up cron job for renewal
.RE
.SS Certificate Files
.RS
.EX
/etc/letsencrypt/live/{domain}/
  ├── cert.pem       - SSL certificate
  ├── chain.pem      - Certificate chain
  ├── fullchain.pem  - Full certificate chain
  └── privkey.pem    - Private key
.EE
.RE
.SS Certbot Options
.RS
.IP \(bu 2
Authenticator: dns-duckdns (DuckDNS DNS challenge)
.IP \(bu 2
Challenge type: DNS (TXT record)
.IP \(bu 2
Propagation: 90 seconds (configurable)
.IP \(bu 2
Expand: Add domains to existing certificate
.IP \(bu 2
Agreement: Automatic ToS acceptance
.IP \(bu 2
Email: Optional (defaults to register-unsafely-without-email)
.RE
.SS Certificate Renewal
.RS
.IP 1. 3
Pulls latest certbot Docker image
.IP 2. 3
Runs certbot renew command in container
.IP 3. 3
Updates all certificates nearing expiration
.IP 4. 3
Logs renewal status and results
.IP 5. 3
Refreshes cron job configuration
.RE
.SH CRON JOB AUTOMATION
Automated scheduling for DNS updates and SSL renewal:
.SS Cron File Location
.RS
/etc/cron.d/{domain}
.RE
.SS Default Schedule
.RS
.EX
# DuckDNS for example.duckdns.org
*/5 * * * * root duckdns update example.duckdns.org
0 3 */8 * * root duckdns letsencrypt renew example.duckdns.org
.EE
.RE
.SS Update Schedule
.RS
.IP \(bu 2
Frequency: Every 5 minutes (*/5 * * * *)
.IP \(bu 2
Purpose: Keep DNS record current with dynamic IP
.IP \(bu 2
Mode: Silent (DUCKDNS_SILENT=true)
.IP \(bu 2
Logging: ~/.local/log/duckdns/cron.{domain}.log
.RE
.SS Renewal Schedule
.RS
.IP \(bu 2
Frequency: Every 8 days at 3 AM (0 3 */8 * *)
.IP \(bu 2
Purpose: Renew SSL certificates before expiration
.IP \(bu 2
Requirements: Root access for /etc/letsencrypt
.IP \(bu 2
Container: infinityofspace/certbot_dns_duckdns:latest
.RE
.SS Cron Management
.RS
.EX
# Install cron jobs
duckdns cron install example.duckdns.org

# Remove cron jobs
duckdns cron remove example.duckdns.org

# Manually run cron update
duckdns cron run example.duckdns.org
.EE
.RE
.SH DOMAIN HANDLING
Domain name normalization and validation:
.SS Full Domain Format
.RS
Accepts both short and full domain names:
.IP \(bu 2
Short: example → normalized to example.duckdns.org
.IP \(bu 2
Full: example.duckdns.org → used as-is
.IP \(bu 2
Custom: Domains with multiple dots preserved
.RE
.SS Domain Detection
.RS
.EX
__set_full_domain() {
  # If domain contains multiple dots, use as-is
  echo "$domain" | grep -q '\\..*\\.' || domain="$domain.duckdns.org"
  export DUCKDNS_DOMAIN="$domain"
}
.EE
.RE
.SH TXT RECORDS
DuckDNS supports TXT record updates for DNS challenges:
.SS TXT Record Update
.RS
.EX
export DUCKDNS_TEXT="verification_string"
duckdns update example.duckdns.org
.EE
.RE
.SS URL Encoding
.RS
TXT records are automatically URL encoded:
.IP \(bu 2
Spaces: %20
.IP \(bu 2
Special characters: %, #, $, &, +, /, :, ;, =, ?, @, [, ]
.IP \(bu 2
Quotes: %22
.RE
.SS API Call with TXT
.RS
.EX
https://www.duckdns.org/update/?domains={domain}
  &token={api_key}
  &txt={encoded_text}
  &verbose=true
.EE
.RE
.SH EXAMPLES
.TP
.B duckdns update example
Update example.duckdns.org with current public IP
.TP
.B duckdns update example.duckdns.org yes
Auto-detect and update IPv4 address
.TP
.B duckdns update example 1.2.3.4
Set specific IPv4 address
.TP
.B duckdns update example yes 2001:db8::1
Auto-detect IPv4, set specific IPv6
.TP
.B duckdns update example yes yes
Auto-detect both IPv4 and IPv6 addresses
.TP
.B export DUCKDNS_TEXT="challenge"; duckdns update example
Update with TXT record for DNS challenge
.TP
.B duckdns ssl create example.duckdns.org
Generate Let's Encrypt certificates (domain + wildcard)
.TP
.B duckdns ssl renew example.duckdns.org
Renew expiring certificates
.TP
.B duckdns cron install example.duckdns.org
Setup automated updates and SSL renewal
.TP
.B duckdns cron run example.duckdns.org
Manually trigger cron update (silent)
.TP
.B duckdns info
Show all configuration variables
.SH FILES
.TP
.B ~/.config/myscripts/duckdns/settings.conf
User configuration file for DuckDNS settings and API credentials
.TP
.B ~/.local/share/myscripts/duckdns/backups/
Configuration backup directory
.TP
.B ~/.local/log/duckdns/
Log file directory for DNS updates and SSL operations
.TP
.B ~/.local/log/duckdns/cron.{domain}.log
Cron job execution log for specific domain
.TP
.B ~/.local/log/duckdns/lecert.log
Let's Encrypt certificate generation log
.TP
.B ~/.local/tmp/system_scripts/duckdns/
Temporary files directory
.TP
.B ~/.cache/duckdns/
Cache directory
.TP
.B /etc/cron.d/{domain}
System cron file for domain updates and SSL renewal
.TP
.B /etc/letsencrypt/live/{domain}/
Let's Encrypt SSL certificate storage directory
.SH ENVIRONMENT VARIABLES
.TP
.B DUCKDNS_API_KEY
DuckDNS API token (required for all operations)
.TP
.B DUCKDNS_DOMAIN
Default domain to manage (can override with command arguments)
.TP
.B DUCKDNS_CLEAR
Clear/reset domain IP (default: false)
.TP
.B DUCKDNS_API_URL
DuckDNS API endpoint (default: https://www.duckdns.org)
.TP
.B DUCKDNS_EXTERNAL_IP
IP detection service URL (default: https://ifcfg.us)
.TP
.B DUCKDNS_TEXT
TXT record value for DNS challenges
.TP
.B DUCKDNS_LETSENCRYPT_EMAIL
Email for Let's Encrypt certificate registration
.TP
.B DUCKDNS_LETSENCRYPT_PROPAGATION
DNS propagation wait time in seconds (default: 90)
.TP
.B DUCKDNS_CERTBOT_CONTAINER
Docker image for certbot (default: infinityofspace/certbot_dns_duckdns:latest)
.TP
.B DUCKDNS_SILENT
Suppress output messages when set to "true"
.TP
.B DUCKDNS_OUTPUT_COLOR_1
Primary output color code (default: 33 for yellow)
.TP
.B DUCKDNS_OUTPUT_COLOR_2
Secondary output color code (default: 5 for magenta)
.TP
.B DUCKDNS_OUTPUT_COLOR_GOOD
Success message color code (default: 2 for green)
.TP
.B DUCKDNS_OUTPUT_COLOR_ERROR
Error message color code (default: 1 for red)
.TP
.B DUCKDNS_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.SH CONFIGURATION FILE
The configuration file located at ~/.config/myscripts/duckdns/settings.conf supports the following settings:
.PP
.RS 4
.EX
# Required: DuckDNS API token from https://www.duckdns.org
DUCKDNS_API_KEY="your-api-token-here"

# Default domain to manage
DUCKDNS_DOMAIN="example.duckdns.org"

# Optional: Email for Let's Encrypt
DUCKDNS_LETSENCRYPT_EMAIL="admin@example.com"

# Optional: DNS propagation time (seconds)
DUCKDNS_LETSENCRYPT_PROPAGATION="120"

# Optional: Custom certbot container
DUCKDNS_CERTBOT_CONTAINER="infinityofspace/certbot_dns_duckdns:v1.0"
.EE
.RE
.SH EXIT STATUS
.TP
.B 0
Success - DNS update or SSL operation completed successfully
.TP
.B 1
General error or API failure
.TP
.B 2
Configuration error (missing API key or domain)
.TP
.B 3
Required command not found
.TP
.B 4
Network connectivity failure
.SH DUCKDNS API
DuckDNS API integration details:
.SS API Endpoints
.RS
.IP \(bu 2
Update: https://www.duckdns.org/update/
.IP \(bu 2
Method: GET with query parameters
.IP \(bu 2
Authentication: Token-based (API key)
.RE
.SS Required Parameters
.RS
.IP \(bu 2
domains: Domain name to update
.IP \(bu 2
token: DuckDNS API key
.RE
.SS Optional Parameters
.RS
.IP \(bu 2
ip: IPv4 address (detected if omitted)
.IP \(bu 2
ipv6: IPv6 address (detected if omitted)
.IP \(bu 2
txt: TXT record value (URL encoded)
.IP \(bu 2
clear: Reset domain IP (true/false)
.IP \(bu 2
verbose: Extended response information
.RE
.SS Response Format
.RS
.EX
OK
192.0.2.1
2001:db8::1
UPDATED
.EE
.RE
.SS Response Codes
.RS
.IP \(bu 2
OK: Update successful
.IP \(bu 2
KO: Update failed (authentication or rate limit)
.IP \(bu 2
NOCHANGE: Record already up-to-date
.IP \(bu 2
UPDATED: IP address changed
.RE
.SH DOCKER INTEGRATION
Let's Encrypt certificate management via Docker:
.SS Container Requirements
.RS
.IP \(bu 2
Image: infinityofspace/certbot_dns_duckdns:latest
.IP \(bu 2
Network: Requires DNS resolution (--dns=1.1.1.1)
.IP \(bu 2
Volumes: /etc/letsencrypt, /var/log/letsencrypt
.IP \(bu 2
Cleanup: Container removed after each run (--rm)
.RE
.SS Volume Mounts
.RS
.EX
-v "/etc/letsencrypt:/etc/letsencrypt"   # Certificate storage
-v "/var/log/letsencrypt:/var/log/letsencrypt"  # Logs
.EE
.RE
.SS Certbot Command
.RS
.EX
certbot certonly -v \\
  --expand \\
  --agree-tos \\
  --non-interactive \\
  --register-unsafely-without-email \\
  --authenticator dns-duckdns \\
  --preferred-challenges dns \\
  --dns-duckdns-token "$DUCKDNS_API_KEY" \\
  --dns-duckdns-propagation-seconds 90 \\
  -d "example.duckdns.org" -d "*.example.duckdns.org"
.EE
.RE
.SH USE CASES
.SS Home Server DDNS
.RS
.IP 1. 3
Sign up for DuckDNS account and get API token
.IP 2. 3
Configure duckdns with domain and API key
.IP 3. 3
Install cron job for automatic IP updates
.IP 4. 3
Access home server via example.duckdns.org
.IP 5. 3
IP stays current even with ISP DHCP changes
.RE
.SS SSL Certificate Automation
.RS
.IP 1. 3
Create Let's Encrypt certificates for domain
.IP 2. 3
Certificates include wildcard (*.domain)
.IP 3. 3
Setup cron for automatic renewal every 8 days
.IP 4. 3
Use certificates in web server (nginx, apache)
.IP 5. 3
Always have valid HTTPS certificates
.RE
.SS Web Service Hosting
.RS
.IP 1. 3
Point DuckDNS domain to home/VPS IP
.IP 2. 3
Generate SSL certificates with duckdns
.IP 3. 3
Configure web server with certificates
.IP 4. 3
Enable HTTPS on your services
.IP 5. 3
Automatic renewal prevents expiration
.RE
.SS Development Environment
.RS
.IP 1. 3
Use DuckDNS for development server
.IP 2. 3
Test HTTPS locally with valid certificates
.IP 3. 3
Share development environment with team
.IP 4. 3
Consistent domain across environments
.RE
.SH NOTES
.IP \(bu 2
Requires DuckDNS account and API token from https://www.duckdns.org
.IP \(bu 2
API key must be set in config or DUCKDNS_API_KEY environment variable
.IP \(bu 2
Domain names automatically normalized with .duckdns.org suffix
.IP \(bu 2
IPv4 and IPv6 addresses auto-detected when argument is 'yes' or 'true'
.IP \(bu 2
SSL certificate generation requires Docker installed and running
.IP \(bu 2
Cron jobs require root/sudo access for /etc/cron.d/ writes
.IP \(bu 2
Let's Encrypt certificates valid for 90 days, renewal every 8 days recommended
.IP \(bu 2
Wildcard certificates cover both domain and all subdomains
.IP \(bu 2
DNS propagation time configurable (default 90 seconds)
.IP \(bu 2
Silent mode (cron) logs all output to log files
.SH TIPS
.SS Get DuckDNS API Token
.RS
.IP 1. 3
Visit https://www.duckdns.org
.IP 2. 3
Sign in with Google, GitHub, Reddit, or Twitter
.IP 3. 3
Token displayed at top of page
.IP 4. 3
Add token to ~/.config/myscripts/duckdns/settings.conf
.RE
.SS Test DNS Update
.RS
.EX
# Update and verify
duckdns update example.duckdns.org
nslookup example.duckdns.org

# Check with dig
dig +short example.duckdns.org
dig +short AAAA example.duckdns.org
.EE
.RE
.SS Verify SSL Certificates
.RS
.EX
# Check certificate files
ls -la /etc/letsencrypt/live/example.duckdns.org/

# Verify certificate details
openssl x509 -in /etc/letsencrypt/live/example.duckdns.org/cert.pem -text -noout

# Check expiration
openssl x509 -in /etc/letsencrypt/live/example.duckdns.org/cert.pem -noout -dates
.EE
.RE
.SS Monitor Cron Jobs
.RS
.EX
# View cron configuration
cat /etc/cron.d/example.duckdns.org

# Check cron logs
tail -f ~/.local/log/duckdns/cron.example.duckdns.org.log

# Manually test cron execution
duckdns cron run example.duckdns.org
.EE
.RE
.SH TROUBLESHOOTING
.SS API Authentication Failure
.RS
.IP \(bu 2
Verify DUCKDNS_API_KEY is set correctly
.IP \(bu 2
Check token at https://www.duckdns.org
.IP \(bu 2
Ensure config file is sourced
.IP \(bu 2
Try: duckdns info to see configuration
.RE
.SS IP Detection Failure
.RS
.IP \(bu 2
Check internet connectivity
.IP \(bu 2
Test: curl -4 https://ifcfg.us
.IP \(bu 2
Test: curl -6 https://ifcfg.us
.IP \(bu 2
Use manual IP: duckdns update domain 1.2.3.4
.RE
.SS SSL Certificate Creation Fails
.RS
.IP \(bu 2
Ensure Docker is installed and running
.IP \(bu 2
Check /var/log/letsencrypt/ for errors
.IP \(bu 2
Verify DNS record exists before certbot
.IP \(bu 2
Check DNS propagation (may need longer wait)
.IP \(bu 2
Ensure /etc/letsencrypt permissions (chmod 777)
.RE
.SS Cron Job Not Running
.RS
.IP \(bu 2
Verify file exists: ls /etc/cron.d/example.duckdns.org
.IP \(bu 2
Check cron service: systemctl status cron
.IP \(bu 2
Verify permissions on cron file
.IP \(bu 2
Check logs: tail -f ~/.local/log/duckdns/cron.*.log
.IP \(bu 2
Test manually: duckdns cron run domain
.RE
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \(bu 2
bash - Bash shell for script execution
.IP \(bu 2
curl - HTTP requests for API calls and IP detection
.IP \(bu 2
grep - Text pattern matching for validation
.RE
.TP
.B Optional:
.RS
.IP \(bu 2
docker - Container runtime for Let's Encrypt certbot
.IP \(bu 2
sudo - Root access for cron and certificate management
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \(co 2022 Jason Hempstead, Casjays Developments
.br
License: WTFPL (Do What The F*** You Want To Public License)
.SH SEE ALSO
.BR curl (1),
.BR docker (1),
.BR certbot (1),
.BR cron (8)
.PP
DuckDNS Service:
.br
https://www.duckdns.org
.PP
Let's Encrypt Documentation:
.br
https://letsencrypt.org/docs/
.PP
Certbot DNS DuckDNS Plugin:
.br
https://github.com/infinityofspace/certbot_dns_duckdns
