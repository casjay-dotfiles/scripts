.TH GEN-DNS "1" "December 2025" "gen-dns 202208062305-git" "User Commands"
.SH NAME
gen-dns \- BIND9 DNS zone file generator and configuration manager
.SH SYNOPSIS
.B gen-dns
[\\fI\\,OPTIONS\\fR] [\\fI\\,DOMAIN\\fR] [\\fI\\,HOST_IP4\\fR] [\\fI\\,HOST_IP6\\fR] [\\fI\\,DNS_1_IP4\\fR] [\\fI\\,DNS_2_IP4\\fR] [\\fI\\,DNS_1_IP6\\fR] [\\fI\\,DNS_2_IP6\\fR]
.PP
.B gen-dns
.BR edit
[\\fI\\,DOMAIN\\fR]
.PP
.B gen-dns
.BR update
.PP
.B gen-dns
.BR help
.SH DESCRIPTION
.B gen-dns
is a comprehensive BIND9 DNS zone file generator and configuration manager that automates the creation and management of DNS zone files with support for IPv4 and IPv6 addressing. It provides templating, hosting provider presets, dynamic DNS updates, TSIG key generation, and complete zone transfer configuration for both primary and secondary DNS servers.
.PP
The script simplifies complex DNS configuration by providing interactive prompts for IP addressing, support for multiple hosting provider templates (Cloudflare, GitHub Pages, Vercel, etc.), automatic serial number generation and versioning, zone file import and editing capabilities, named.conf integration and management, TSIG key generation for secure zone transfers, dynamic DNS update support (RFC 2136), and IPv6/IPv4 dual-stack support with fallback.
.PP
gen-dns is particularly useful for automated DNS server deployment and configuration, managing multiple domains with consistent templates, migrating DNS zones between providers, setting up primary/secondary DNS server pairs, dynamic DNS for certbot DNS-01 challenges, testing DNS configurations in development environments, and maintaining DNS infrastructure as code.
.SH COMMANDS
.TP
.BR edit " " \\fI\\,DOMAIN\\fR
Edit an existing DNS zone configuration. Opens the zone file for the specified domain in the configured editor (default: vim). Searches for zone files in this order: zone file directory, config directory, bind directory, named.conf file. Exits with error if no matching configuration found.
.TP
.BR update
Update dynamic DNS records using nsupdate (RFC 2136). Reads DDNS configuration from /etc/certbot/dynamic_dns.conf if available. Automatically detects current public IPv4 and IPv6 addresses from ifcfg.us. Updates A record (IPv4) and AAAA record (IPv6) for the current hostname. Uses TSIG key authentication for secure updates. Requires nsupdate command to be available.
.TP
.BR help
Display brief usage information showing the command syntax and available positional arguments. Provides quick reference for domain and IP address ordering.
.TP
(default)
When no command is specified, generates a new DNS zone configuration using either interactive prompts or command-line arguments. Creates complete zone file with SOA, NS, A, AAAA, and other records as configured.
.SH OPTIONS
.TP
.BR \\-\\-dir \" \" \\fI\\,DIRECTORY\\fR
Set working directory for zone file operations
.TP
.BR \\-\\-silent
Suppress notification output and verbose messaging
.TP
.BR \\-\\-help
Display comprehensive help message with usage information, examples, and all available options
.TP
.BR \\-\\-config
Generate or regenerate user configuration file at ~/.config/myscripts/gen-dns/settings.conf
.TP
.BR \\-\\-version
Show script version information and exit
.TP
.BR \\-\\-options
Display all available command-line options with descriptions
.TP
.BR \\-\\-debug
Enable debug mode with verbose output, command tracing, and detailed execution information
.TP
.BR \\-\\-raw
Disable colorized output for plain text display (useful for logging or piping)
.TP
.BR \\-\\-completions \" \" \\fI\\,TYPE\\fR
Generate completion strings for shell integration (short, long, array, list)
.TP
.BR \\-\\-copy
Copy DNS templates from template repository or CASJAYSDEVDIR to local template directory. Performs git pull if template directory already exists as git repository.
.TP
.BR \\-\\-domain \" \" \\fI\\,DOMAIN\\fR
Specify domain name for zone file generation (e.g., example.com)
.TP
.BR \\-\\-hostip4 \" \" \\fI\\,IP_ADDRESS\\fR
Set IPv4 address for the host (@) record in the zone file
.TP
.BR \\-\\-hostip6 \" \" \\fI\\,IP_ADDRESS\\fR
Set IPv6 address for the host (@) AAAA record in the zone file
.TP
.BR \\-\\-dns_1_ip4 \" \" \\fI\\,IP_ADDRESS\\fR
Set IPv4 address for the first DNS server (dns1 A record)
.TP
.BR \\-\\-dns_2_ip4 \" \" \\fI\\,IP_ADDRESS\\fR
Set IPv4 address for the second DNS server (dns2 A record)
.TP
.BR \\-\\-dns_1_ip6 \" \" \\fI\\,IP_ADDRESS\\fR
Set IPv6 address for the first DNS server (dns1 AAAA record)
.TP
.BR \\-\\-dns_2_ip6 \" \" \\fI\\,IP_ADDRESS\\fR
Set IPv6 address for the second DNS server (dns2 AAAA record)
.TP
.BR \\-\\-force
Force re-prompt for all IP addresses even if already configured. Overrides saved configuration values.
.TP
.BR \\-\\-forwarders \" \" \\fI\\,IP_ADDRESS\\fR
Add DNS forwarder IP address (can be specified multiple times). Default forwarders: 1.1.1.1, 8.8.8.8, 8.8.4.4
.TP
.BR \\-\\-transfer \" \" \\fI\\,IP_ADDRESS\\fR
Add IP address allowed for zone transfers (can be specified multiple times). Configures also-notify and allow-transfer directives.
.TP
.BR \\-\\-import \" \" \\fI\\,DIRECTORY\\fR
Import existing zone file from specified directory. Preserves non-comment records while updating IP addresses.
.TP
.BR \\-\\-template \" \" \\fI\\,FILE\\fR
Specify custom zone file template. Can be filename in template directory or full path to template file. Default: simple.zone
.TP
.BR \\-\\-provider \" \" \\fI\\,NAME\\fR
Use predefined hosting provider configuration (bitly, casjay, casjaysdev, cloudflare, github, google, pihole, redirect, vercel, wordpress). Sets appropriate IP addresses, nameservers, and TXT records for the provider.
.SH POSITIONAL ARGUMENTS
Arguments can be provided in order without option flags:
.TP
.BR DOMAIN
Domain name for the zone file (e.g., example.com, subdomain.example.org)
.TP
.BR HOST_IP4
IPv4 address for the host @ record
.TP
.BR HOST_IP6
IPv6 address for the host @ AAAA record (or "none" to skip IPv6)
.TP
.BR DNS_1_IP4
IPv4 address for first DNS server (dns1)
.TP
.BR DNS_2_IP4
IPv4 address for second DNS server (dns2)
.TP
.BR DNS_1_IP6
IPv6 address for first DNS server (or "none" to skip)
.TP
.BR DNS_2_IP6
IPv6 address for second DNS server (or "none" to skip)
.SH ZONE FILE GENERATION
How gen-dns creates BIND9 zone files:
.SS Template Processing
.RS
.EX
# Zone file creation workflow
1. Load template from template directory
2. Replace placeholders with actual values:
   - REPLACE_SERIAL → Auto-generated serial (YYYYMMDDnn)
   - REPLACE_DOMAIN → Domain name
   - REPLACE_DNS_1_4 → First DNS IPv4
   - REPLACE_DNS_2_4 → Second DNS IPv4
   - REPLACE_DNS_1_6 → First DNS IPv6
   - REPLACE_DNS_2_6 → Second DNS IPv6
   - REPLACE_HOST_4 → Host IPv4
   - REPLACE_HOST_6 → Host IPv6
   - REPLACE_NAME_SERVER_1 → First nameserver
   - REPLACE_NAME_SERVER_2 → Second nameserver
   - REPLACE_HWINFO → Hardware info TXT record
   - REPLACE_TXTINFO → Hosting info TXT record
   - REPLACE_IMPORTED → Imported zone records
3. Save to zone file directory
4. Create named.conf entry
5. Optionally copy to /var/named/master
.EE
.RE
.SS Serial Number Generation
.RS
.EX
# Automatic serial number generation
Format: YYYYMMDDnn (e.g., 2025120601)

# For new zones
Serial: <current_date>01

# For existing zones (increment)
Previous: 2025120501
New:      2025120502

# Versioning
gen-dns creates backups before overwriting
Prompts for confirmation if zone exists
.EE
.IP \\(bu 2
YYYYMMDDnn format (10 digits)
.IP \\(bu 2
Auto-increments for existing zones
.IP \\(bu 2
Date-based for new zones
.IP \\(bu 2
Ensures proper SOA serial ordering
.RE
.SS Zone Record Types
.RS
Zone files include these record types:
.IP \\(bu 2
.B SOA:
Start of Authority with serial, refresh, retry, expire, TTL
.IP \\(bu 2
.B NS:
Nameserver records (dns1, dns2)
.IP \\(bu 2
.B A:
IPv4 address records for host and DNS servers
.IP \\(bu 2
.B AAAA:
IPv6 address records (if configured)
.IP \\(bu 2
.B CNAME:
Canonical name aliases (from template)
.IP \\(bu 2
.B MX:
Mail exchange records (from template)
.IP \\(bu 2
.B TXT:
Text records (HWINFO, hosting info, verifications)
.IP \\(bu 2
.B HINFO:
Hardware information records
.RE
.SH HOSTING PROVIDERS
Predefined configurations for common hosting providers:
.SS Cloudflare
.RS
.EX
gen-dns --provider cloudflare example.com

# Configuration:
Host IP4: 132.226.33.75
Host IP6: 2603:c020:4005:4d00:3c49:c239:91c9:74c3
DNS IP4:  108.162.193.65
DNS IP6:  2a06:98c1:50::ac40:2141
NS1:      anuj.ns.cloudflare.com.
NS2:      nola.ns.cloudflare.com.
HWINFO:   "Proxy" "Shared Hosting"
TXTINFO:  "Hosted on cloudflare.com"
.EE
.RE
.SS GitHub Pages
.RS
.EX
gen-dns --provider github example.com

# Configuration:
Host IP4: 185.199.108.153
Host IP6: (none)
HWINFO:   "Web" "Shared hosting"
TXTINFO:  "Hosted on github.io"
.EE
.RE
.SS Vercel
.RS
.EX
gen-dns --provider vercel example.com

# Configuration:
Host IP4: 76.76.21.21
Host IP6: (none)
HWINFO:   "Web" "Serverless"
TXTINFO:  "Hosted on now.sh"
.EE
.RE
.SS Bitly
.RS
.EX
gen-dns --provider bitly example.com

# Configuration:
Host IP4: 67.199.248.12 ; 67.199.248.13
Host IP6: (none)
HWINFO:   "Web" "url shortner"
TXTINFO:  "Hosted on bit.ly"
.EE
.RE
.SS WordPress
.RS
.EX
gen-dns --provider wordpress example.com

# Configuration:
Host IP4: 64.98.145.30
Host IP6: (none)
HWINFO:   "Web" "Shared Hosting"
TXTINFO:  "Hosted on wordpress.com"
.EE
.RE
.SS Redirect Center
.RS
.EX
gen-dns --provider redirect example.com

# Configuration:
Host IP4: 54.84.55.102
Host IP6: (none)
HWINFO:   "Web" "Redirection service"
TXTINFO:  "Hosted on redirect.center"
.EE
.RE
.SS Google Cloud
.RS
.EX
gen-dns --provider google example.com

# Configuration:
HWINFO:   "hosted" "Virtualized Host"
TXTINFO:  "Hosted on google cloud"
.EE
.RE
.SS Self-Hosted (Casjay/Pihole)
.RS
.EX
# Casjay hosting
gen-dns --provider casjay example.com
HWINFO:   "libvirt" "Virtualized Host"
TXTINFO:  "Hosted on casjaydns.com"

# CasjaysDev hosting
gen-dns --provider casjaysdev example.com
TXTINFO:  "Hosted on casjaysdev.pro"

# Pi-hole DNS
gen-dns --provider pihole example.com
TXTINFO:  "Hosted on casjay.pro"
.EE
.RE
.SH DYNAMIC DNS UPDATES
How gen-dns supports dynamic DNS (DDNS) with nsupdate:
.SS Configuration
.RS
.EX
# Certbot dynamic DNS config
# /etc/certbot/dynamic_dns.conf
dns_rfc2136_server = ns1.example.com
dns_rfc2136_name = certbot.
dns_rfc2136_secret = base64_encoded_secret_key
dns_rfc2136_algorithm = HMAC-SHA512

# Environment variables (optional)
export GEN_DNS_DDNS_ZONE="example.com"
export GEN_DNS_DDNS_SERVER="ns1.example.com"
export GEN_DNS_DDNS_KEY_NAME="certbot."
export GEN_DNS_DDNS_KEY_SECRET="base64_key"
.EE
.RE
.SS Update Process
.RS
.EX
# Run dynamic DNS update
gen-dns update

# What happens:
1. Reads DDNS config from certbot or environment
2. Detects current public IPv4 (curl ifcfg.us)
3. Detects current public IPv6 (curl -6 ifcfg.us)
4. Generates nsupdate commands with TSIG auth
5. Updates A record (IPv4) with 60 second TTL
6. Updates AAAA record (IPv6) with 60 second TTL
7. Sends updates to configured DNS server

# Example nsupdate commands generated:
key hmac-sha512:certbot. <secret>
server ns1.example.com
zone example.com
update add host.example.com. 60 A 203.0.113.42
send
.EE
.IP \\(bu 2
Automatic public IP detection
.IP \\(bu 2
TSIG key authentication
.IP \\(bu 2
IPv4 and IPv6 support
.IP \\(bu 2
60-second TTL for dynamic records
.IP \\(bu 2
Compatible with certbot DNS-01 challenges
.RE
.SS Certbot Integration
.RS
.EX
# Use with Let's Encrypt DNS-01 challenge
# 1. Configure DDNS
gen-dns update

# 2. Setup certbot with RFC 2136
certbot certonly \\\\
  --dns-rfc2136 \\\\
  --dns-rfc2136-credentials /etc/certbot/dynamic_dns.conf \\\\
  -d example.com -d *.example.com

# 3. DDNS updates TXT records for validation
_acme-challenge.example.com 60 TXT "validation_string"
.EE
.RE
.SH ZONE FILE MANAGEMENT
Managing DNS zone configurations:
.SS Interactive Creation
.RS
.EX
# Start interactive zone creation
gen-dns

# Prompts in order:
1. What is your Domain name: example.com
2. What is your DNS Servers IP [82.29.128.43]:
3. What is your DNS Servers IP [103.124.104.139]:
4. What is your hosts IP address [172.245.70.133]:
5. Does your dns or host have IP6? [y/N]:
   (If yes, prompts for IPv6 addresses)

# Result:
✓ Zone created: ~/.config/myscripts/gen-dns/named/zones/example.com.zone
✓ Config created: ~/.config/myscripts/gen-dns/named/config/example.com.conf
✓ Named.conf updated with zone entry
.EE
.RE
.SS Command-Line Creation
.RS
.EX
# Specify all parameters
gen-dns example.com 203.0.113.10 2001:db8::1 \\\\
  203.0.113.1 203.0.113.2 \\\\
  2001:db8::100 2001:db8::101

# IPv4 only (use "none" for IPv6)
gen-dns example.com 203.0.113.10 none \\\\
  203.0.113.1 203.0.113.2

# With options
gen-dns --domain example.com \\\\
  --hostip4 203.0.113.10 \\\\
  --dns_1_ip4 203.0.113.1 \\\\
  --dns_2_ip4 203.0.113.2
.EE
.RE
.SS Editing Zones
.RS
.EX
# Edit existing zone
gen-dns edit example.com

# Opens in editor (default: vim)
# File: ~/.config/myscripts/gen-dns/named/zones/example.com.zone

# After editing:
1. Save changes
2. Check syntax: named-checkzone example.com example.com.zone
3. Reload BIND: rndc reload example.com
.EE
.RE
.SS Importing Zones
.RS
.EX
# Import from existing zone file
gen-dns --import /path/to/zones example.com

# Import process:
1. Reads existing zone file
2. Filters out comments and SOA/NS records
3. Extracts A/AAAA/CNAME/MX records
4. Merges with new template
5. Updates IP addresses
6. Preserves custom records

# Imported records appear in zone with marker:
;  ********** begin imported settings  **********
www    IN  A      203.0.113.20
api    IN  CNAME  www
;  ********** end imported settings    **********
.EE
.RE
.SS Replacing Zones
.RS
.EX
# Replace existing zone
gen-dns example.com

# If zone exists, prompts:
Would you like to replace the zone? [y/N]

# If yes:
1. Creates backup version
2. Increments serial number
3. Preserves imported records
4. Updates IP addresses
5. Saves new zone file

# Backup location:
~/.local/share/myscripts/gen-dns/backups/
.EE
.RE
.SH NAMED.CONF INTEGRATION
How gen-dns integrates with BIND9 named.conf:
.SS Zone Configuration Files
.RS
.EX
# Generated zone config
# ~/.config/myscripts/gen-dns/named/config/example.com.conf

zone "example.com" {
    type master;
    file "~/.config/myscripts/gen-dns/named/zones/example.com.zone";
    notify yes;
    also-notify { 203.0.113.2; };
    allow-update {
        key "certbot.";
        key "dhcp-key";
        trusted;
    };
    allow-transfer {
        203.0.113.2;
        key "backup-key";
    };
};
.EE
.IP \\(bu 2
Type: master (primary server)
.IP \\(bu 2
Notify: yes (notify slaves on updates)
.IP \\(bu 2
Also-notify: Secondary DNS servers
.IP \\(bu 2
Allow-update: TSIG keys for DDNS
.IP \\(bu 2
Allow-transfer: IPs/keys for zone transfers
.RE
.SS Named.conf Updates
.RS
.EX
# Automatic named.conf integration
gen-dns example.com

# Adds to named.conf:
#  ********** begin example.com              **********
zone "example.com" {
    type master;
    file "/path/to/zones/example.com.zone";
    notify yes;
    also-notify { 203.0.113.2; };
    allow-update {key "certbot."; key "dhcp-key"; trusted;};
    allow-transfer { 203.0.113.2; key "backup-key"; };
};
#  ********** end example.com                **********

# If running as root with /etc/named.conf writable:
✓ Copies zone to /var/named/master/
✓ Updates /etc/named.conf directly
✓ Sets ownership: chown named:named
.EE
.RE
.SS TSIG Keys
.RS
.EX
# Auto-generated TSIG keys in named.conf

key "certbot." {
    algorithm hmac-sha512;
    secret "base64_encoded_secret_key";
};

key "dhcp-key" {
    algorithm hmac-sha512;
    secret "base64_encoded_secret_key";
};

key "backup-key" {
    algorithm hmac-sha512;
    secret "base64_encoded_secret_key";
};

key "rndc-key" {
    algorithm hmac-sha512;
    secret "base64_encoded_secret_key";
};
.EE
.IP \\(bu 2
Algorithm: HMAC-SHA512
.IP \\(bu 2
Auto-generated on first run
.IP \\(bu 2
Base64 encoded secrets
.IP \\(bu 2
Used for secure updates and transfers
.RE
.SS Forwarders Configuration
.RS
.EX
# DNS forwarders in named.conf
forwarders {
    1.1.1.1;    # Cloudflare
    8.8.8.8;    # Google
    8.8.4.4;    # Google
};

# Custom forwarders
gen-dns --forwarders 9.9.9.9 \\\\
  --forwarders 149.112.112.112 \\\\
  example.com

# Result in named.conf:
forwarders {
    9.9.9.9;         # Quad9
    149.112.112.112; # Quad9 secondary
};
.EE
.RE
.SH TEMPLATES
Zone file templates and customization:
.SS Default Templates
.RS
.EX
# Template directory structure
~/.config/myscripts/gen-dns/templates/
├── simple.zone      # Basic zone template
├── domain.zone      # Full-featured template
├── named.conf       # Named.conf template
└── README.md        # Template documentation

# Copy templates from repository
gen-dns --copy
.EE
.RE
.SS Template Placeholders
.RS
Templates use these replacement markers:
.IP \\(bu 2
.B REPLACE_SERIAL:
Auto-generated serial number (YYYYMMDDnn)
.IP \\(bu 2
.B REPLACE_DOMAIN:
Domain name from configuration
.IP \\(bu 2
.B REPLACE_DNS_1_4:
First DNS server IPv4
.IP \\(bu 2
.B REPLACE_DNS_2_4:
Second DNS server IPv4
.IP \\(bu 2
.B REPLACE_DNS_1_6:
First DNS server IPv6
.IP \\(bu 2
.B REPLACE_DNS_2_6:
Second DNS server IPv6
.IP \\(bu 2
.B REPLACE_HOST_4:
Host IPv4 address
.IP \\(bu 2
.B REPLACE_HOST_6:
Host IPv6 address
.IP \\(bu 2
.B REPLACE_NAME_SERVER_1:
First nameserver hostname
.IP \\(bu 2
.B REPLACE_NAME_SERVER_2:
Second nameserver hostname
.IP \\(bu 2
.B REPLACE_HWINFO:
Hardware info TXT record
.IP \\(bu 2
.B REPLACE_TXTINFO:
Hosting info TXT record
.IP \\(bu 2
.B REPLACE_IMPORTED:
Imported zone records
.RE
.SS Custom Templates
.RS
.EX
# Create custom template
cat > ~/.config/myscripts/gen-dns/templates/my-template.zone << 'EOF'
$ORIGIN REPLACE_DOMAIN.
$TTL 3600

@   IN  SOA dns1.REPLACE_DOMAIN. admin.REPLACE_DOMAIN. (
    REPLACE_SERIAL  ; Serial
    3600            ; Refresh
    1800            ; Retry
    604800          ; Expire
    86400 )         ; Minimum TTL

; Nameservers
@       IN  NS      dns1.REPLACE_DOMAIN.
@       IN  NS      dns2.REPLACE_DOMAIN.

; DNS servers
dns1    IN  A       REPLACE_DNS_1_4
dns2    IN  A       REPLACE_DNS_2_4

; Host records
@       IN  A       REPLACE_HOST_4
www     IN  CNAME   @

; Custom records
; Add your records here

; Imported settings
REPLACE_IMPORTED
EOF

# Use custom template
gen-dns --template my-template.zone example.com
.EE
.RE
.SS Template Repository
.RS
.EX
# Git-based templates
cd ~/.config/myscripts/gen-dns/templates
git init
git remote add origin https://github.com/user/dns-templates.git
git pull origin main

# Auto-update templates
gen-dns --copy
# Performs: git pull (if .git exists)
.EE
.RE
.SH EXAMPLES
.TP
.B gen-dns
Interactive zone creation with prompts for all settings
.TP
.B gen-dns example.com
Create zone for example.com with interactive IP prompts
.TP
.B gen-dns example.com 203.0.113.10
Create zone with specified host IPv4, prompt for DNS servers
.TP
.B gen-dns example.com 203.0.113.10 2001:db8::1
Create zone with host IPv4 and IPv6, prompt for DNS servers
.TP
.B gen-dns example.com 203.0.113.10 none 203.0.113.1 203.0.113.2
Create IPv4-only zone with specified DNS servers
.TP
.B gen-dns --provider cloudflare example.com
Create zone with Cloudflare hosting preset
.TP
.B gen-dns --provider github pages.example.com
Create zone for GitHub Pages hosting
.TP
.B gen-dns --domain example.com --hostip4 203.0.113.10 --dns_1_ip4 203.0.113.1
Create zone using long-form options
.TP
.B gen-dns --template custom.zone example.com
Create zone using custom template
.TP
.B gen-dns --import /var/named/zones example.com
Import existing zone and update with new IPs
.TP
.B gen-dns --force example.com
Re-create zone with forced IP prompts even if configured
.TP
.B gen-dns --forwarders 9.9.9.9 --forwarders 149.112.112.112 example.com
Create zone with custom DNS forwarders (Quad9)
.TP
.B gen-dns --transfer 203.0.113.2 --transfer 203.0.113.3 example.com
Create zone allowing transfers to secondary servers
.TP
.B gen-dns edit example.com
Edit existing zone file in configured editor
.TP
.B gen-dns update
Update dynamic DNS records with current public IP
.TP
.B gen-dns --copy
Copy/update DNS templates from repository
.TP
.B gen-dns --config
Generate configuration file with defaults
.SH USE CASES
How to use gen-dns in different scenarios:
.SS Primary/Secondary DNS Setup
.RS
.EX
# Primary server (ns1.example.com)
gen-dns --transfer 203.0.113.2 example.com

# Zone config allows transfers to secondary
also-notify { 203.0.113.2; };
allow-transfer { 203.0.113.2; key "backup-key"; };

# Secondary server (ns2.example.com)
# In named.conf:
zone "example.com" {
    type slave;
    masters { 203.0.113.1; };
    file "slaves/example.com.zone";
};

# Test zone transfer
dig @203.0.113.2 example.com AXFR
.EE
.RE
.SS Multi-Domain Hosting
.RS
.EX
# Create multiple domains with same DNS servers
gen-dns --dns_1_ip4 203.0.113.1 --dns_2_ip4 203.0.113.2 \\\\
  --hostip4 203.0.113.10 domain1.com

gen-dns --dns_1_ip4 203.0.113.1 --dns_2_ip4 203.0.113.2 \\\\
  --hostip4 203.0.113.11 domain2.com

gen-dns --dns_1_ip4 203.0.113.1 --dns_2_ip4 203.0.113.2 \\\\
  --hostip4 203.0.113.12 domain3.com

# All domains share same DNS infrastructure
# Different host IPs for different websites
.EE
.RE
.SS Development/Testing
.RS
.EX
# Local DNS server for testing
gen-dns --dns_1_ip4 127.0.0.1 \\\\
  --dns_2_ip4 127.0.0.1 \\\\
  --hostip4 192.168.1.100 \\\\
  test.local

# Start BIND9 locally
named -c ~/.config/myscripts/gen-dns/named/named.conf -g

# Test resolution
dig @localhost test.local
dig @localhost www.test.local
.EE
.RE
.SS Let's Encrypt DNS-01 Challenge
.RS
.EX
# 1. Setup dynamic DNS
gen-dns --provider cloudflare example.com
gen-dns update

# 2. Configure certbot RFC 2136
cat > /etc/certbot/dynamic_dns.conf << 'EOF'
dns_rfc2136_server = ns1.example.com
dns_rfc2136_name = certbot.
dns_rfc2136_secret = <TSIG_key_from_named.conf>
dns_rfc2136_algorithm = HMAC-SHA512
EOF

# 3. Obtain wildcard certificate
certbot certonly \\\\
  --dns-rfc2136 \\\\
  --dns-rfc2136-credentials /etc/certbot/dynamic_dns.conf \\\\
  -d example.com -d *.example.com

# certbot uses DDNS to create validation TXT records
.EE
.RE
.SS Migration Between Providers
.RS
.EX
# Export current zone from old provider
dig @old-dns.example.com example.com AXFR > old-zone.txt

# Import and recreate with new provider
gen-dns --import . \\\\
  --provider cloudflare \\\\
  example.com

# Result:
# - Imports existing records from old-zone.txt
# - Updates DNS server IPs for new provider
# - Preserves custom A/CNAME/MX records
# - Adds Cloudflare nameservers
.EE
.RE
.SS Dual-Stack IPv4/IPv6
.RS
.EX
# Configure full dual-stack DNS
gen-dns example.com \\\\
  203.0.113.10 2001:db8::10 \\\\
  203.0.113.1 203.0.113.2 \\\\
  2001:db8::1 2001:db8::2

# Zone includes both A and AAAA records:
@       IN  A       203.0.113.10
@       IN  AAAA    2001:db8::10
dns1    IN  A       203.0.113.1
dns1    IN  AAAA    2001:db8::1
dns2    IN  A       203.0.113.2
dns2    IN  AAAA    2001:db8::2

# Test both protocols
dig example.com A
dig example.com AAAA
.EE
.RE
.SS Automated Deployment
.RS
.EX
#!/bin/bash
# Automated DNS zone deployment

domains=(
  "example.com"
  "example.net"
  "example.org"
)

dns_servers="203.0.113.1 203.0.113.2"

for domain in "$\{domains[@]\}"; do
  gen-dns --silent \\\\
    --domain "$domain" \\\\
    --dns_1_ip4 203.0.113.1 \\\\
    --dns_2_ip4 203.0.113.2 \\\\
    --hostip4 203.0.113.10 \\\\
    --transfer 203.0.113.2
done

# Reload BIND9
rndc reload
.EE
.RE
.SH FILES
.TP
.B ~/.config/myscripts/gen-dns/settings.conf
User configuration file with default IP addresses, provider settings, and preferences
.TP
.B ~/.config/myscripts/gen-dns/named/named.conf
Generated BIND9 named.conf file with all zone entries, TSIG keys, and forwarder configuration
.TP
.B ~/.config/myscripts/gen-dns/named/zones/
Directory containing generated zone files (domain.zone format)
.TP
.B ~/.config/myscripts/gen-dns/named/config/
Directory containing individual zone configuration files (domain.conf format)
.TP
.B ~/.config/myscripts/gen-dns/templates/
Template directory with zone file templates and named.conf template
.TP
.B ~/.local/share/myscripts/gen-dns/backups/
Configuration backup directory for zone file versions
.TP
.B ~/.local/log/gen-dns/
Log file directory for debugging and error tracking
.TP
.B ~/.local/tmp/system_scripts/gen-dns/
Temporary files directory for intermediate processing
.TP
.B ~/.cache/gen-dns/
Cache directory for template storage and quick access
.TP
.B /etc/certbot/dynamic_dns.conf
Certbot dynamic DNS configuration (RFC 2136) for DDNS integration
.TP
.B /etc/named.conf
System BIND9 configuration (updated if running as root)
.TP
.B /var/named/master/
System zone file directory (zones copied here if running as root)
.SH ENVIRONMENT VARIABLES
.TP
.B GEN_DNS_EDITOR
Editor to use for zone file editing (default: vim)
.TP
.B GEN_DNS_DEFAULT_DOMAIN
Default domain name for zone creation
.TP
.B GEN_DNS_DEFAULT_HOST_IP4
Default IPv4 address for host record (default: 172.245.70.133)
.TP
.B GEN_DNS_DEFAULT_HOST_IP6
Default IPv6 address for host record
.TP
.B GEN_DNS_DEFAULT_DNS_1_IP4
Default IPv4 for first DNS server (default: 82.29.128.43)
.TP
.B GEN_DNS_DEFAULT_DNS_1_IP6
Default IPv6 for first DNS server (default: 2402:d0c0:15:87::63d9:19c9)
.TP
.B GEN_DNS_DEFAULT_DNS_2_IP4
Default IPv4 for second DNS server (default: 103.124.104.139)
.TP
.B GEN_DNS_DEFAULT_DNS_2_IP6
Default IPv6 for second DNS server (default: 2402:d0c0:12:7ab::72cb:cd67)
.TP
.B GEN_DNS_HAS_IPV6
Enable IPv6 support (y/n)
.TP
.B GEN_DNS_DEFAULT_NAMESERVER_1
First nameserver hostname (default: dns1)
.TP
.B GEN_DNS_DEFAULT_NAMESERVER_2
Second nameserver hostname (default: dns2)
.TP
.B GEN_DNS_DEFAULT_HWINFO
Hardware info TXT record (default: "libvirt" "Virtualized Host")
.TP
.B GEN_DNS_DEFAULT_TXTINFO
Hosting info TXT record (default: "Hosted on casjaysdev.pro")
.TP
.B GEN_DNS_TEMPLATE_DIR
Template directory location (default: ~/.config/myscripts/gen-dns/templates)
.TP
.B GEN_DNS_DEFAULT_TEMPLATE
Default template file to use (default: simple.zone)
.TP
.B GEN_DNS_SERIAL_FMT
Serial number date format (default: %Y%m%d)
.TP
.B GEN_DNS_FORWARDERS
DNS forwarders (comma-separated, default: 1.1.1.1, 8.8.8.8, 8.8.4.4)
.TP
.B GEN_DNS_TRANSFER
IPs allowed for zone transfer (comma-separated)
.TP
.B GEN_DNS_DDNS_ZONE
Dynamic DNS zone name for nsupdate
.TP
.B GEN_DNS_DDNS_SERVER
Dynamic DNS server for nsupdate
.TP
.B GEN_DNS_DDNS_KEY_NAME
TSIG key name for DDNS authentication
.TP
.B GEN_DNS_DDNS_KEY_SECRET
TSIG key secret for DDNS authentication
.TP
.B GEN_DNS_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.TP
.B GEN_DNS_NOTIFY_CLIENT_NAME
Application name for notifications (default: gen-dns)
.TP
.B GEN_DNS_NOTIFY_CLIENT_ICON
Icon for notifications (default: notification-new)
.TP
.B GEN_DNS_NOTIFY_CLIENT_URGENCY
Notification urgency level (default: normal)
.TP
.B GEN_DNS_GOOD_NAME
Success notification title (default: Great:)
.TP
.B GEN_DNS_ERROR_NAME
Error notification title (default: Error:)
.TP
.B GEN_DNS_GOOD_MESSAGE
Success message text (default: No errors reported)
.TP
.B GEN_DNS_ERROR_MESSAGE
Error message text (default: Errors were reported)
.TP
.B GEN_DNS_OUTPUT_COLOR_1
Primary output color code (default: 33 for yellow)
.TP
.B GEN_DNS_OUTPUT_COLOR_2
Secondary output color code (default: 5 for magenta)
.TP
.B GEN_DNS_OUTPUT_COLOR_GOOD
Success message color (default: 2 for green)
.TP
.B GEN_DNS_OUTPUT_COLOR_ERROR
Error message color (default: 1 for red)
.TP
.B SEND_NOTIFICATION
Runtime notification control (set to "no" to disable)
.SH CONFIGURATION FILE
The configuration file located at ~/.config/myscripts/gen-dns/settings.conf supports the following settings:
.PP
.RS 4
.EX
# Default domain and IP addressing
GEN_DNS_DEFAULT_DOMAIN=""
GEN_DNS_DEFAULT_HOST_IP4="172.245.70.133"
GEN_DNS_DEFAULT_HOST_IP6=""
GEN_DNS_DEFAULT_DNS_1_IP4="82.29.128.43"
GEN_DNS_DEFAULT_DNS_1_IP6="2402:d0c0:0015:0087:0000:0000:63d9:19c9"
GEN_DNS_DEFAULT_DNS_2_IP4="103.124.104.139"
GEN_DNS_DEFAULT_DNS_2_IP6="2402:d0c0:0012:07ab:0000:0000:72cb:cd67"

# IPv6 support
GEN_DNS_HAS_IPV6=""

# Nameservers
GEN_DNS_DEFAULT_NAMESERVER_1="dns1"
GEN_DNS_DEFAULT_NAMESERVER_2="dns2"

# TXT records
GEN_DNS_DEFAULT_HWINFO='"libvirt" "Virtualized Host"'
GEN_DNS_DEFAULT_TXTINFO='"Hosted on casjaysdev.pro"'

# Templates
GEN_DNS_TEMPLATE_DIR="$HOME/.config/myscripts/gen-dns/templates"
GEN_DNS_DEFAULT_TEMPLATE="$GEN_DNS_TEMPLATE_DIR/simple.zone"

# Editor
GEN_DNS_EDITOR="vim"

# Serial format
GEN_DNS_SERIAL_FMT="%Y%m%d"

# Forwarders and transfers
GEN_DNS_FORWARDERS="1.1.1.1, 8.8.8.8, 8.8.4.4"
GEN_DNS_TRANSFER=""

# Notification settings
GEN_DNS_NOTIFY_ENABLED="yes"
GEN_DNS_GOOD_NAME="Great:"
GEN_DNS_ERROR_NAME="Error:"
GEN_DNS_GOOD_MESSAGE="No errors reported"
GEN_DNS_ERROR_MESSAGE="Errors were reported"
GEN_DNS_NOTIFY_CLIENT_NAME="gen-dns"
GEN_DNS_NOTIFY_CLIENT_ICON="notification-new"
GEN_DNS_NOTIFY_CLIENT_URGENCY="normal"

# Output colorization
GEN_DNS_OUTPUT_COLOR_1="33"
GEN_DNS_OUTPUT_COLOR_2="5"
GEN_DNS_OUTPUT_COLOR_GOOD="2"
GEN_DNS_OUTPUT_COLOR_ERROR="1"

# Hosting provider presets
GEN_DNS_DEFAULT_HOST_BITLY_IP4="67.199.248.12 ; 67.199.248.13"
GEN_DNS_DEFAULT_HOST_VERCEL_IP4="76.76.21.21"
GEN_DNS_DEFAULT_HOST_PIHOLE_IP4="132.226.33.75"
GEN_DNS_DEFAULT_HOST_PIHOLE_IP6="2603:c020:4005:4d00:3c49:c239:91c9:74c3"
GEN_DNS_DEFAULT_HOST_CASJAY_IP4="150.230.183.65"
GEN_DNS_DEFAULT_HOST_CASJAY_IP6="2603:c020:4005:4d00:1f79:387:4f01:4b5"
GEN_DNS_DEFAULT_HOST_GITHUB_IP4="185.199.108.153"
GEN_DNS_DEFAULT_HOST_REDIRECT_IP4="54.84.55.102"
GEN_DNS_DEFAULT_HOST_WORDPRESS_IP4="64.98.145.30"
GEN_DNS_DEFAULT_HOST_CLOUDFLARE_IP4="108.162.193.65"
GEN_DNS_DEFAULT_HOST_CLOUDFLARE_IP6="2a06:98c1:50::ac40:2141"
GEN_DNS_DEFAULT_HOST_CLOUDFLARE_NAMESERVER_1="anuj.ns.cloudflare.com."
GEN_DNS_DEFAULT_HOST_CLOUDFLARE_NAMESERVER_2="nola.ns.cloudflare.com."
.EE
.RE
.SH EXIT STATUS
.TP
.B 0
Success - zone file generated, edited, or updated successfully
.TP
.B 1
Error - zone creation failed, template not found, or invalid configuration
.SH NOTES
.IP \\(bu 2
Zone serial numbers use YYYYMMDDnn format
.IP \\(bu 2
Existing zones increment serial automatically
.IP \\(bu 2
IPv6 records (AAAA) only added if IPv6 configured
.IP \\(bu 2
Templates support custom placeholders
.IP \\(bu 2
TSIG keys auto-generated on first run
.IP \\(bu 2
Zone files can be edited manually after generation
.IP \\(bu 2
Import preserves existing A/AAAA/CNAME/MX records
.IP \\(bu 2
Running as root enables /etc/named.conf integration
.IP \\(bu 2
DDNS requires nsupdate command to be available
.IP \\(bu 2
Provider presets include predefined IP addresses
.IP \\(bu 2
Multiple forwarders and transfer IPs supported
.IP \\(bu 2
Named.conf includes all necessary TSIG keys
.SH TIPS
.SS Zone Testing
.RS
.EX
# Check zone file syntax
named-checkzone example.com \\\\
  ~/.config/myscripts/gen-dns/named/zones/example.com.zone

# Check named.conf syntax
named-checkconf \\\\
  ~/.config/myscripts/gen-dns/named/named.conf

# Test zone resolution
dig @localhost example.com SOA
dig @localhost example.com NS
dig @localhost example.com A
dig @localhost www.example.com
.EE
.RE
.SS BIND9 Integration
.RS
.EX
# Include gen-dns zones in /etc/named.conf
include "~/.config/myscripts/gen-dns/named/named.conf";

# Or copy zones to system location (as root)
gen-dns example.com
# Automatically copies to /var/named/master/
# Updates /etc/named.conf directly

# Reload BIND9
rndc reload
# Or: systemctl reload named
.EE
.RE
.SS Batch Zone Creation
.RS
.EX
# Create script for multiple domains
cat > create-zones.sh << 'EOF'
#!/bin/bash
domains=(example.com example.net example.org)
for domain in "$\{domains[@]\}"; do
  gen-dns --silent \\\\
    --domain "$domain" \\\\
    --dns_1_ip4 203.0.113.1 \\\\
    --dns_2_ip4 203.0.113.2 \\\\
    --hostip4 203.0.113.10
done
EOF

chmod +x create-zones.sh
./create-zones.sh
.EE
.RE
.SS Custom Provider Preset
.RS
.EX
# Add custom provider to config
cat >> ~/.config/myscripts/gen-dns/settings.conf << 'EOF'
# Custom hosting provider
GEN_DNS_DEFAULT_HOST_MYHOST_IP4="192.0.2.10"
GEN_DNS_DEFAULT_HOST_MYHOST_IP6="2001:db8::10"
EOF

# Use in provider selection function
# (requires code modification for new provider)
.EE
.RE
.SS Zone File Version Control
.RS
.EX
# Initialize git repo for zones
cd ~/.config/myscripts/gen-dns/named/zones
git init
git add *.zone
git commit -m "Initial zone files"

# Track changes
gen-dns example.com
git diff example.com.zone
git commit -am "Updated example.com zone"

# Restore previous version
git log example.com.zone
git checkout <commit> example.com.zone
.EE
.RE
.SH TROUBLESHOOTING
.SS Zone File Not Created
.RS
If zone file generation fails:
.IP \\(bu 2
Check template exists: ls ~/.config/myscripts/gen-dns/templates/
.IP \\(bu 2
Copy templates: gen-dns --copy
.IP \\(bu 2
Check directory permissions: ls -ld ~/.config/myscripts/gen-dns/
.IP \\(bu 2
Verify domain name is valid (no special characters)
.IP \\(bu 2
Check disk space: df -h ~/.config
.RE
.SS Invalid Serial Number
.RS
If serial number issues occur:
.IP \\(bu 2
Format must be YYYYMMDDnn (10 digits)
.IP \\(bu 2
Check system date: date +%Y%m%d
.IP \\(bu 2
Manually edit serial in zone file if needed
.IP \\(bu 2
Ensure serial increments: new > old
.IP \\(bu 2
Use named-checkzone to verify
.RE
.SS DDNS Updates Failing
.RS
If dynamic DNS updates fail:
.IP \\(bu 2
Check nsupdate installed: which nsupdate
.IP \\(bu 2
Verify TSIG key matches in named.conf and certbot config
.IP \\(bu 2
Test DDNS server reachable: ping ns1.example.com
.IP \\(bu 2
Check allow-update in zone configuration
.IP \\(bu 2
Verify TSIG key algorithm matches (HMAC-SHA512)
.IP \\(bu 2
Check zone file permissions (must be writable by named)
.IP \\(bu 2
Review BIND9 logs: journalctl -u named -f
.RE
.SS Named.conf Not Updated
.RS
If named.conf doesn't include new zone:
.IP \\(bu 2
Check zone config exists: ls ~/.config/myscripts/gen-dns/named/config/
.IP \\(bu 2
Verify domain in named.conf: grep example.com named.conf
.IP \\(bu 2
Run as root for /etc/named.conf updates
.IP \\(bu 2
Manually include: include "/path/to/zone.conf";
.IP \\(bu 2
Check file permissions on named.conf
.RE
.SS IPv6 Issues
.RS
If IPv6 addresses not working:
.IP \\(bu 2
Verify IPv6 support enabled: GEN_DNS_HAS_IPV6=y
.IP \\(bu 2
Use "none" if no IPv6: gen-dns domain.com 1.2.3.4 none
.IP \\(bu 2
Check IPv6 format: 2001:db8::1 (valid colon-hex notation)
.IP \\(bu 2
Template must include REPLACE_HOST_6 and REPLACE_DNS_6
.IP \\(bu 2
Test IPv6 connectivity: ping6 2001:db8::1
.RE
.SS Template Not Found
.RS
If template errors occur:
.IP \\(bu 2
Copy templates: gen-dns --copy
.IP \\(bu 2
Check template directory: echo $GEN_DNS_TEMPLATE_DIR
.IP \\(bu 2
Verify template file exists: ls $GEN_DNS_TEMPLATE_DIR/simple.zone
.IP \\(bu 2
Use full path: gen-dns --template /full/path/to/template.zone
.IP \\(bu 2
Check template syntax (no syntax errors in placeholders)
.RE
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \\(bu 2
bash - Bash shell for script execution
.IP \\(bu 2
sed - Stream editor for text replacement
.IP \\(bu 2
grep - Pattern matching for filtering
.IP \\(bu 2
cat - File concatenation
.IP \\(bu 2
mkdir - Directory creation
.IP \\(bu 2
tee - Output redirection
.RE
.TP
.B Optional:
.RS
.IP \\(bu 2
nsupdate - Dynamic DNS updates (RFC 2136)
.IP \\(bu 2
curl - Retrieve public IP addresses for DDNS
.IP \\(bu 2
named-checkzone - Validate zone file syntax
.IP \\(bu 2
named-checkconf - Validate named.conf syntax
.IP \\(bu 2
rndc - BIND9 remote control for reloading zones
.IP \\(bu 2
git - Template version control
.IP \\(bu 2
notifications - Desktop notification system
.IP \\(bu 2
dig - DNS query tool for testing
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \\(co 2022 Jason Hempstead, Casjays Developments
.br
License: WTFPL (Do What The F*** You Want To Public License)
.SH SEE ALSO
.BR named (8),
.BR named-checkzone (8),
.BR named-checkconf (8),
.BR nsupdate (1),
.BR rndc (8),
.BR dig (1),
.BR zone (5)
