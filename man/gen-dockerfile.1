.TH GEN-DOCKERFILE "1" "February 2026" "gen-dockerfile 202602020740-git" "User Commands"
.SH NAME
gen-dockerfile \- Docker container configuration generator with multiple template support
.SH SYNOPSIS
.B gen-dockerfile
[\\fI\\,TEMPLATE\\fR] [\\fI\\,OPTIONS\\fR] [\\fI\\,DIRECTORY\\fR] [\\fI\\,IMAGE_NAME\\fR] [\\fI\\,GIT_REPO\\fR]
.SH DESCRIPTION
.B gen-dockerfile
is a comprehensive Dockerfile and container project generator that automates the creation of Docker container projects with pre-configured templates, entrypoint scripts, CI/CD workflows, and directory structures. It supports multiple Linux distributions (Alpine, Debian, Rocky Linux), specialized templates (web servers, X.org, scratch), and generates complete container ecosystems with .env configuration, GitHub/Gitea Actions workflows, and Docker entrypoint management.
.PP
The script simplifies Docker project creation by providing template-based Dockerfile generation for common base images, automatic rootfs directory structure creation, entrypoint script generation with init system integration, .env.scripts configuration file management, Gitea/GitHub Actions workflow automation, package manager scripts for container package installation, git repository initialization with .gitignore and README, and version tag management with date-based tagging support.
.PP
gen-dockerfile is particularly useful for DevOps engineers creating standardized container images, system administrators building custom container solutions, developers needing reproducible container environments, CI/CD pipeline automation for container builds, and organizations requiring consistent Docker project structures.
.SH USAGE
.B gen-dockerfile alpine
.PP
Generate Alpine Linux container project in current directory.
.PP
.B gen-dockerfile debian --dir /path/to/project
.PP
Generate Debian container project in specified directory.
.PP
.B gen-dockerfile rhel --template rockylinux --tag 9
.PP
Generate Rocky Linux 9 container project.
.PP
.B gen-dockerfile scratch --dockerfile
.PP
Generate only Dockerfile (no rootfs structure).
.SH OPTIONS
.TP
.BR \\-\\-help
Display help message with usage information
.TP
.BR \\-\\-config
Generate or regenerate user configuration file
.TP
.BR \\-\\-version
Show script version information and exit
.TP
.BR \\-\\-options
Display all available command-line options
.TP
.BR \\-\\-debug
Enable debug mode with verbose output
.TP
.BR \\-\\-raw
Disable colorized output for plain text display
.TP
.BR \\-\\-template \" \" \\fI\\,TEMPLATE\\fR
Specify container template (scratch, alpine, debian, rhel, xorg, web)
.TP
.BR \\-\\-tag \" \" \\fI\\,TAG\\fR
Specify Docker image tag (default: latest)
.TP
.BR \\-\\-image \" \" \\fI\\,IMAGE\\fR
Specify Docker image repository name
.TP
.BR \\-\\-dockerfile
Create only Dockerfile without rootfs structure
.TP
.BR \\-\\-distro-name \" \" \\fI\\,NAME\\fR
Specify base distribution name
.TP
.BR \\-\\-distro-tag \" \" \\fI\\,TAG\\fR
Specify base distribution version tag
.TP
.BR \\-\\-startup
Create init system startup scripts
.TP
.BR \\-\\-nogit
Do not initialize git repository
.TP
.BR \\-\\-dir \" \" \\fI\\,DIRECTORY\\fR
Specify working directory for project (defaults to current directory)
.SH TEMPLATES
Available container templates:
.TP
.B scratch
Minimal container template with basic structure
.RS
.IP \\(bu 2
FROM scratch base image
.IP \\(bu 2
Minimal file structure
.IP \\(bu 2
Custom init system
.IP \\(bu 2
Best for micro-containers
.RE
.TP
.B alpine
Alpine Linux based container (lightweight)
.RS
.IP \\(bu 2
FROM alpine:latest
.IP \\(bu 2
apk package manager
.IP \\(bu 2
Minimal footprint (~5MB base)
.IP \\(bu 2
Best for production containers
.RE
.TP
.B debian
Debian Linux based container
.RS
.IP \\(bu 2
FROM debian:latest
.IP \\(bu 2
apt/dpkg package manager
.IP \\(bu 2
Full GNU userland
.IP \\(bu 2
Best for development
.RE
.TP
.B rhel
Red Hat Enterprise Linux compatible (Rocky Linux)
.RS
.IP \\(bu 2
FROM rockylinux:latest
.IP \\(bu 2
dnf/yum package manager
.IP \\(bu 2
Enterprise Linux compatible
.IP \\(bu 2
Best for enterprise deployments
.RE
.TP
.B xorg
X.org graphical environment container
.RS
.IP \\(bu 2
X11 display server
.IP \\(bu 2
Graphics libraries
.IP \\(bu 2
Desktop environment support
.IP \\(bu 2
Best for GUI applications
.RE
.TP
.B web
Web server container template
.RS
.IP \\(bu 2
Apache or Nginx pre-configured
.IP \\(bu 2
PHP/Python/Node.js support
.IP \\(bu 2
SSL/TLS configuration
.IP \\(bu 2
Best for web applications
.RE
.SH PROJECT STRUCTURE
Generated project directory structure:
.SS Complete Project Layout
.RS
.EX
project/
├── Dockerfile                  # Main Dockerfile
├── .env.scripts                # Environment configuration
├── .dockerignore               # Docker ignore rules
├── README.md                   # Project documentation
├── .gitignore                  # Git ignore rules
├── .gitea/workflows/
│   └── docker.yaml             # CI/CD workflow
├── rootfs/
│   └── usr/
│       └── local/
│           ├── bin/
│           │   ├── entrypoint.sh   # Container entrypoint
│           │   └── pkmgr           # Package manager script
│           └── etc/
│               └── docker/
│                   └── functions/
│                       └── entrypoint.sh  # Entrypoint functions
.EE
.RE
.SS Rootfs Directory Structure
.RS
Standard Unix filesystem hierarchy:
.IP \\(bu 2
/usr/local/bin/ - Executable scripts
.IP \\(bu 2
/usr/local/etc/docker/ - Docker-specific configs
.IP \\(bu 2
/usr/local/share/ - Shared data files
.IP \\(bu 2
/etc/ - System configuration
.IP \\(bu 2
/var/log/ - Log directories
.IP \\(bu 2
/tmp/ - Temporary files
.RE
.SH CONFIGURATION FILES
How gen-dockerfile manages configuration:
.SS .env.scripts File
.RS
Environment variables for build and runtime:
.EX
# Image Configuration
IMAGE_NAME="myapp"
IMAGE_TAG="latest"
IMAGE_REPO="myorg/myapp"

# Base Image
DISTRO_NAME="alpine"
DISTRO_TAG="3.19"

# Build Configuration
BUILD_DATE="202512091200"
VERSION="1.0.0"

# Runtime Configuration
CONTAINER_USER="appuser"
CONTAINER_UID="1000"
WORKDIR="/app"
.EE
.RE
.SS Dockerfile Template Variables
.RS
Variables substituted in templates:
.IP \\(bu 2
{{IMAGE_NAME}} - Container image name
.IP \\(bu 2
{{IMAGE_TAG}} - Image version tag
.IP \\(bu 2
{{DISTRO_NAME}} - Base distribution
.IP \\(bu 2
{{DISTRO_TAG}} - Distribution version
.IP \\(bu 2
{{BUILD_DATE}} - Build timestamp
.IP \\(bu 2
{{REPO}} - Git repository URL
.IP \\(bu 2
{{MAINTAINER}} - Image maintainer
.RE
.SS .dockerignore Generation
.RS
Automatically created with common exclusions:
.EX
.git
.github
.gitea
*.md
*.log
.env
.env.*
node_modules
__pycache__
*.pyc
.DS_Store
Thumbs.db
.EE
.RE
.SH ENTRYPOINT SCRIPTS
Container initialization and runtime management:
.SS entrypoint.sh Structure
.RS
Main entrypoint script features:
.IP \\(bu 2
Environment variable validation
.IP \\(bu 2
Pre-start initialization hooks
.IP \\(bu 2
Service startup management
.IP \\(bu 2
Signal handling (SIGTERM, SIGINT)
.IP \\(bu 2
Graceful shutdown procedures
.IP \\(bu 2
User/permission management
.IP \\(bu 2
Log file initialization
.RE
.SS Entrypoint Function Library
.RS
Common functions in /usr/local/etc/docker/functions/entrypoint.sh:
.IP \\(bu 2
__init_container() - Container initialization
.IP \\(bu 2
__start_services() - Service startup
.IP \\(bu 2
__stop_services() - Graceful shutdown
.IP \\(bu 2
__check_health() - Health check logic
.IP \\(bu 2
__configure_permissions() - File permissions
.IP \\(bu 2
__setup_logging() - Log configuration
.RE
.SS Package Manager Script (pkmgr)
.RS
Container package installation wrapper:
.EX
#!/usr/bin/env bash
# Detects package manager (apk, apt, dnf, yum)
# Provides unified installation interface

# Usage in Dockerfile:
RUN pkmgr install nginx php-fpm

# Automatically uses correct package manager
# Handles package name variations
.EE
.RE
.SH CI/CD INTEGRATION
Automated build and deployment workflows:
.SS Gitea Actions Workflow
.RS
Generated .gitea/workflows/docker.yaml:
.EX
name: Docker Build and Push

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build Docker image
        run: docker build -t $IMAGE_NAME:$IMAGE_TAG .
      - name: Push to registry
        run: docker push $IMAGE_NAME:$IMAGE_TAG
.EE
.RE
.SS GitHub Actions Compatibility
.RS
.IP \\(bu 2
Same workflow format for GitHub
.IP \\(bu 2
Multi-platform builds with buildx
.IP \\(bu 2
Automatic tag detection
.IP \\(bu 2
Registry authentication
.IP \\(bu 2
Vulnerability scanning integration
.RE
.SH VERSION MANAGEMENT
Image versioning and tagging:
.SS Tag Generation
.RS
.IP \\(bu 2
Latest tag (default)
.IP \\(bu 2
Semantic versioning (1.0.0, 1.0, 1)
.IP \\(bu 2
Date-based tags (USE_DATE → YYYYMMDDHHMM)
.IP \\(bu 2
Git commit SHA tags
.IP \\(bu 2
Branch-based tags
.RE
.SS Multi-Version Support
.RS
.IP \\(bu 2
Dockerfile.latest - Latest version
.IP \\(bu 2
Dockerfile.1.0 - Specific version
.IP \\(bu 2
.env.scripts.latest - Latest config
.IP \\(bu 2
.env.scripts.1.0 - Version-specific config
.RE
.SH EXAMPLES
.TP
.B gen-dockerfile alpine
Create Alpine Linux container project in current directory
.TP
.B gen-dockerfile debian --dir /opt/myapp
Create Debian container in /opt/myapp directory
.TP
.B gen-dockerfile rhel --distro-tag 9
Create Rocky Linux 9 container project
.TP
.B gen-dockerfile scratch --dockerfile
Create only Dockerfile without rootfs structure
.TP
.B gen-dockerfile web --template nginx --tag 1.0.0
Create nginx web server container with version 1.0.0
.TP
.B gen-dockerfile xorg --image myorg/xapp
Create X.org container with custom image name
.TP
.B gen-dockerfile alpine --tag latest --nogit
Create Alpine container without git initialization
.TP
.B gen-dockerfile debian --startup --distro-name ubuntu --distro-tag 22.04
Create Ubuntu 22.04 container with init scripts
.SH FILES
.TP
.B ~/.config/myscripts/gen-dockerfile/settings.conf
User configuration file
.TP
.B ~/.local/share/myscripts/gen-dockerfile/backups/
Configuration backup directory
.TP
.B ~/.local/log/gen-dockerfile/
Log file directory
.TP
.B ~/.local/tmp/system_scripts/gen-dockerfile/
Temporary files directory
.TP
.B ~/.cache/gen-dockerfile/
Cache directory
.TP
.B /usr/local/share/CasjaysDev/scripts/templates/
Dockerfile template directory
.TP
.B ./Dockerfile
Generated Dockerfile in project directory
.TP
.B ./.env.scripts
Environment configuration file
.TP
.B ./rootfs/
Container filesystem root directory
.TP
.B ./.gitea/workflows/docker.yaml
CI/CD workflow configuration
.SH ENVIRONMENT VARIABLES
.TP
.B GEN_DOCKERFILE_CWD
Working directory for Dockerfile generation
.TP
.B GEN_DOCKERFILE_TEMPLATE
Container template name (scratch, alpine, debian, rhel, xorg, web)
.TP
.B GEN_DOCKERFILE_SET_VERSION
Docker image version tag
.TP
.B GEN_DOCKERFILE_SET_DISTRO_VERSION
Base distribution version
.TP
.B GEN_DOCKERFILE_DEFAULT_VERSION
Default version if not specified
.TP
.B GEN_DOCKERFILE_DEFAULT_TAGS
Default image tags (space-separated)
.TP
.B GEN_DOCKERFILE_PULL_URL
Base image pull URL (e.g., alpine:3.19)
.TP
.B GEN_DOCKERFILE_GIT_BASE
Git repository base URL
.TP
.B GEN_DOCKER_INIT
Initialize complete project structure (true/false)
.TP
.B GEN_DOCKER_ONLY_DOCKERFILE
Generate only Dockerfile (true/false)
.TP
.B GEN_DOCKERFILE_FORCE
Force overwrite existing files (yes/no)
.TP
.B GEN_DOCKERFILE_BACKUP_EXT
Backup file extension (default: .bak)
.TP
.B BUILDX_BUILD_DATE_FORMAT
Build date format (default: %Y%m%d%H%M)
.TP
.B CASJAYSDEVDIR
CasjaysDev scripts directory
.TP
.B GEN_DOCKERFILE_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.SH CONFIGURATION FILE
The configuration file located at ~/.config/myscripts/gen-dockerfile/settings.conf supports the following settings:
.PP
.RS 4
.EX
# Template Settings
GEN_DOCKERFILE_TEMPLATE="alpine"
GEN_DOCKERFILE_DEFAULT_VERSION="latest"
GEN_DOCKERFILE_DEFAULT_TAGS="latest stable"

# Distribution Settings
GEN_DOCKERFILE_SET_DISTRO_VERSION="3.19"
GEN_DOCKERFILE_PULL_URL="alpine:3.19"

# Build Settings
BUILDX_BUILD_DATE_FORMAT="%Y%m%d%H%M"
GEN_DOCKERFILE_BACKUP_EXT=".bak"

# Project Settings
GEN_DOCKER_INIT="true"
GEN_DOCKER_ONLY_DOCKERFILE="false"
GEN_DOCKERFILE_FORCE="no"

# Notification Settings
GEN_DOCKERFILE_NOTIFY_ENABLED="yes"
.EE
.RE
.SH EXIT STATUS
.TP
.B 0
Success - Dockerfile and project created successfully
.TP
.B 1
Error - generation failed or missing required parameters
.SH NOTES
.IP \\(bu 2
Creates complete Docker project structure by default
.IP \\(bu 2
Use --dockerfile for Dockerfile-only generation
.IP \\(bu 2
Automatically initializes git repository unless --nogit specified
.IP \\(bu 2
Supports versioned Dockerfiles (Dockerfile.version)
.IP \\(bu 2
Template directory: /usr/local/share/CasjaysDev/scripts/templates/
.IP \\(bu 2
Entrypoint functions library auto-generated
.IP \\(bu 2
Package manager script (pkmgr) provides unified interface
.IP \\(bu 2
CI/CD workflow configured for Gitea/GitHub Actions
.IP \\(bu 2
Date-based tagging with USE_DATE in tags list
.IP \\(bu 2
Backup files created with .bak extension before overwrite
.SH TIPS
.SS Alpine Container Best Practices
.RS
.EX
# Create minimal Alpine container
gen-dockerfile alpine --dir /opt/myapp

# Edit Dockerfile to minimize layers
# Use multi-stage builds
# Install runtime dependencies only

# Build optimized image
cd /opt/myapp
docker build --no-cache -t myapp:alpine .
.EE
.RE
.SS Multi-Version Maintenance
.RS
.EX
# Create version 1.0
gen-dockerfile alpine --tag 1.0

# Edit .env.scripts.1.0
# Set version-specific configuration

# Create version 2.0
gen-dockerfile alpine --tag 2.0

# Both versions coexist:
# Dockerfile.1.0 + .env.scripts.1.0
# Dockerfile.2.0 + .env.scripts.2.0
.EE
.RE
.SS Web Server Container
.RS
.EX
# Create nginx web server
gen-dockerfile web --template nginx --dir /opt/webapp

# Customize rootfs/
mkdir -p rootfs/var/www/html
echo "Hello World" > rootfs/var/www/html/index.html

# Build and run
docker build -t webapp:latest .
docker run -p 8080:80 webapp:latest
.EE
.RE
.SS CI/CD Automation
.RS
.EX
# Create project with CI/CD
gen-dockerfile debian --dir /opt/app

# Edit .gitea/workflows/docker.yaml
# Add registry authentication
# Configure multi-platform builds

# Push to trigger build
git add .
git commit -m "Initial commit"
git push origin main
.EE
.RE
.SH USE CASES
.SS Development Containers
.RS
.IP \\(bu 2
Create isolated development environments
.IP \\(bu 2
Standardize team development setups
.IP \\(bu 2
Test applications in clean environments
.IP \\(bu 2
Reproduce production configurations locally
.IP \\(bu 2
Multi-language development containers
.RE
.SS Production Deployments
.RS
.IP \\(bu 2
Build optimized production images
.IP \\(bu 2
Implement multi-stage builds
.IP \\(bu 2
Create minimal attack surface containers
.IP \\(bu 2
Standardize deployment configurations
.IP \\(bu 2
Automated CI/CD pipeline integration
.RE
.SS Microservices Architecture
.RS
.IP \\(bu 2
Generate consistent service containers
.IP \\(bu 2
Standardize logging and monitoring
.IP \\(bu 2
Implement health checks uniformly
.IP \\(bu 2
Manage service dependencies
.IP \\(bu 2
Version control for service images
.RE
.SH TROUBLESHOOTING
.SS Template Not Found
.RS
.IP \\(bu 2
Verify template name: scratch, alpine, debian, rhel, xorg, web
.IP \\(bu 2
Check CASJAYSDEVDIR environment variable
.IP \\(bu 2
Ensure templates directory exists: ls /usr/local/share/CasjaysDev/scripts/templates/
.IP \\(bu 2
Template files must be readable
.RE
.SS Entrypoint Script Not Created
.RS
.IP \\(bu 2
Check gen-script command availability
.IP \\(bu 2
Verify permissions on rootfs/usr/local/bin/
.IP \\(bu 2
Review error messages for missing dependencies
.IP \\(bu 2
Ensure GEN_DOCKER_INIT is not set to false
.IP \\(bu 2
Check if --dockerfile flag was used (skips entrypoint)
.RE
.SS Git Initialization Failed
.RS
.IP \\(bu 2
Verify git is installed: which git
.IP \\(bu 2
Check write permissions in project directory
.IP \\(bu 2
Ensure directory is not already a git repository
.IP \\(bu 2
Use --nogit to skip git initialization
.IP \\(bu 2
Review git configuration: git config --list
.RE
.SS Build Date Format Errors
.RS
.IP \\(bu 2
Verify BUILDX_BUILD_DATE_FORMAT is valid
.IP \\(bu 2
Test format: date +"${BUILDX_BUILD_DATE_FORMAT}"
.IP \\(bu 2
Default format: %Y%m%d%H%M
.IP \\(bu 2
Check locale settings if date fails
.RE
.SS Version Conflicts
.RS
.IP \\(bu 2
Check existing .env.scripts.* files
.IP \\(bu 2
Review Dockerfile.* files for versions
.IP \\(bu 2
Use --force to overwrite existing files
.IP \\(bu 2
Back up existing configurations first
.IP \\(bu 2
Verify GEN_DOCKERFILE_SET_VERSION is correct
.RE
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \\(bu 2
bash - Bash shell for script execution
.IP \\(bu 2
docker - Docker engine for building images
.IP \\(bu 2
git - Version control for project initialization
.IP \\(bu 2
sed - Text substitution for templates
.IP \\(bu 2
grep - Pattern matching
.IP \\(bu 2
awk - Text processing
.RE
.TP
.B Optional:
.RS
.IP \\(bu 2
gen-script - Script generation utility
.IP \\(bu 2
dockerignore - .dockerignore file generator
.IP \\(bu 2
buildx - Docker buildx for multi-platform
.IP \\(bu 2
curl - Template downloads
.RE
.SH SECURITY CONSIDERATIONS
.SS Container Security
.RS
.IP \\(bu 2
Use minimal base images (Alpine preferred)
.IP \\(bu 2
Run containers as non-root user
.IP \\(bu 2
Scan images for vulnerabilities
.IP \\(bu 2
Keep base images updated
.IP \\(bu 2
Minimize installed packages
.IP \\(bu 2
Use multi-stage builds to exclude build tools
.RE
.SS Secret Management
.RS
.IP \\(bu 2
Never include secrets in Dockerfile
.IP \\(bu 2
Use .dockerignore for sensitive files
.IP \\(bu 2
Environment variables for runtime secrets
.IP \\(bu 2
Docker secrets or vault integration
.IP \\(bu 2
Scan for exposed credentials
.RE
.SS Best Practices
.RS
.IP \\(bu 2
Sign images with Docker Content Trust
.IP \\(bu 2
Implement least privilege principle
.IP \\(bu 2
Use read-only root filesystems where possible
.IP \\(bu 2
Drop unnecessary capabilities
.IP \\(bu 2
Implement health checks
.IP \\(bu 2
Use specific base image tags (not :latest)
.IP \\(bu 2
Regular security audits and updates
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \\(co 2023 Jason Hempstead, Casjays Developments
.br
License: WTFPL
.SH SEE ALSO
.BR docker (1),
.BR dockerfile (5),
.BR docker-build (1),
.BR git (1)
.PP
Dockerfile reference:
.br
https://docs.docker.com/engine/reference/builder/
.PP
Docker best practices:
.br
https://docs.docker.com/develop/dev-best-practices/
