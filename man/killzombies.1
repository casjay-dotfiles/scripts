.TH KILLZOMBIES "1" "December 2025" "killzombies 202208121442-git" "User Commands"
.SH NAME
killzombies \- Zombie process detection and termination utility
.SH SYNOPSIS
.B killzombies
[\fI\,COMMAND\fR] [\fI\,OPTIONS\fR]
.SH DESCRIPTION
.B killzombies
is a zombie process management utility that detects and terminates zombie (defunct) processes on Unix systems. It provides both interactive (admin) and automated (cron) modes for zombie process cleanup with parent PID detection, status verification, and optional user confirmation before termination.
.PP
The script simplifies zombie process management by providing automatic zombie detection via ps status checking, parent PID identification for targeted killing, interactive confirmation mode for manual cleanup, automated cron mode for scheduled cleanup, comprehensive process status reporting (PID, PPID, status, command), and logging of automated cleanup operations.
.PP
killzombies is particularly useful for periodic zombie process cleanup via cron, interactive system maintenance and debugging, preventing zombie process accumulation, identifying problematic parent processes, and automated server maintenance without manual intervention.
.PP
.B Note:
Zombie processes occur when a child process completes execution but its parent has not yet read its exit status. The parent PID (not the zombie PID) must be killed to clean up zombies.
.SH COMMANDS
.TP
.BR admin
Interactive mode with user confirmation before killing zombies
.TP
.BR cron
Automated mode for cron jobs (no user interaction, automatic logging)
.TP
.I (no command)
Show usage message
.SH OPTIONS
.TP
.BR \-\-help
Display help message with usage information
.TP
.BR \-\-config
Generate or regenerate user configuration file
.TP
.BR \-\-version
Show script version information and exit
.TP
.BR \-\-options
Display all available command-line options
.TP
.BR \-\-debug
Enable debug mode with verbose output
.TP
.BR \-\-raw
Disable colorized output for plain text display
.TP
.BR \-\-silent
Suppress desktop notifications
.TP
.BR \-\-dir " " \fI\,DIRECTORY\fR
Set working directory
.SH ZOMBIE PROCESS DETECTION
How killzombies finds zombie processes:
.SS Process Status Check
.RS
.EX
ps ax | awk '{print $1}' | grep -v "PID" | xargs -n 1 ps lOp |
  grep -v "UID" | awk '{print"pid: "$3" *** parent_pid: "$4" *** status: "$10" *** process: "$13}' |
  grep ": Z"
.EE
.IP \(bu 2
.B ps ax:
All processes on system
.IP \(bu 2
.B awk '{print $1}':
Extract PIDs
.IP \(bu 2
.B ps lOp:
Long format with PPID for each PID
.IP \(bu 2
.B grep ": Z":
Filter for zombie status (Z)
.IP \(bu 2
Shows PID, parent PID, status, and command
.RE
.SS Zombie Status Indicator
.RS
Process state codes:
.IP \(bu 2
.B Z
\\- Zombie (defunct) process
.IP \(bu 2
Zombie processes have completed execution
.IP \(bu 2
Parent has not read exit status
.IP \(bu 2
Cannot be killed directly (already dead)
.IP \(bu 2
Parent PID must be killed to clean up
.RE
.SS Output Format
.RS
.EX
pid: 12345 *** parent_pid: 1234 *** status: Z *** process: defunct_app
.EE
.IP \(bu 2
.B pid:
Zombie process ID
.IP \(bu 2
.B parent_pid:
Parent process ID (target for killing)
.IP \(bu 2
.B status:
Process status (Z for zombie)
.IP \(bu 2
.B process:
Command name or [defunct]
.RE
.SH ADMIN MODE
Interactive zombie killing with user confirmation:
.SS Detection Phase
.RS
.EX
killzombies admin
# Output: zombie processes found:
# pid: 12345 *** parent_pid: 1234 *** status: Z *** process: defunct_app
# Kill zombies? [y/n]:
.EE
.IP \(bu 2
Scans for zombie processes
.IP \(bu 2
Displays list if zombies found
.IP \(bu 2
Prompts user for confirmation
.IP \(bu 2
Waits 3 seconds for response
.IP \(bu 2
Shows "No zombies found" if clean
.RE
.SS Confirmation Prompt
.RS
.EX
printf_read_question "3" "Kill zombies? [y/n]: " 1 keyb '-s'
.EE
.IP \(bu 2
3-second timeout for user input
.IP \(bu 2
Silent mode (-s) hides input
.IP \(bu 2
Reads single character
.IP \(bu 2
'y' = proceed with killing
.IP \(bu 2
Any other key = cancel operation
.RE
.SS Killing Process
.RS
.EX
ps ax | awk '{print $1}' | grep -v "PID" | xargs -n 1 ps lOp |
  grep -v "UID" | awk '{print$4" status:"$10}' | grep "status:Z" |
  awk '{print $1}' | xargs -n 1 kill -9
.EE
.IP \(bu 2
Extracts parent PIDs (field 4)
.IP \(bu 2
Filters for zombie status
.IP \(bu 2
Kills parent processes with SIGKILL (-9)
.IP \(bu 2
Uses xargs for batch killing
.IP \(bu 2
Output: "killing zombies.." or "User canceled.."
.RE
.SH CRON MODE
Automated zombie killing for scheduled execution:
.SS Automated Detection
.RS
.EX
killzombies cron
# Silent operation (no user interaction)
# Logs to ~/.local/log/killzombies/kill.log
.EE
.IP \(bu 2
No user confirmation required
.IP \(bu 2
Scans for zombies automatically
.IP \(bu 2
Kills parent processes if found
.IP \(bu 2
Logs operations to kill.log
.IP \(bu 2
Designed for cron job execution
.RE
.SS Automated Killing
.RS
Same detection and killing logic as admin mode:
.EX
stat="$(ps ax | ... | grep ": Z")"
count=${#stat}
if (($count > 0)); then
  # Kill parent processes
  ps ax | ... | xargs -n 1 kill -9
  echo $(date)": killed some zombie processes!" >> kill.log
fi
.EE
.IP \(bu 2
Checks if zombies exist (count > 0)
.IP \(bu 2
Kills parent PIDs automatically
.IP \(bu 2
Logs timestamp and action
.IP \(bu 2
No output to stdout (cron-friendly)
.RE
.SS Logging
.RS
Log file location: ~/.local/log/killzombies/kill.log

Format:
.EX
Wed Dec 09 14:30:45 EST 2025: killed some zombie processes!
Wed Dec 09 15:00:12 EST 2025: killed some zombie processes!
.EE
.IP \(bu 2
Timestamp with date command
.IP \(bu 2
Append-only log file
.IP \(bu 2
One line per cleanup operation
.IP \(bu 2
Useful for tracking zombie frequency
.RE
.SH ZOMBIE PROCESS BEHAVIOR
Understanding zombie processes:
.SS What is a Zombie Process?
.RS
.IP \(bu 2
Process that has completed execution
.IP \(bu 2
Parent has not read exit status (via wait())
.IP \(bu 2
Remains in process table as defunct
.IP \(bu 2
Consumes minimal resources (just process table entry)
.IP \(bu 2
Shows as [defunct] or with Z status
.RE
.SS Why Do Zombies Occur?
.RS
.IP \(bu 2
Parent process not calling wait() or waitpid()
.IP \(bu 2
Poor process management in parent
.IP \(bu 2
Parent ignoring SIGCHLD signal
.IP \(bu 2
Bugs in parent process code
.IP \(bu 2
Parent process stuck or hung
.RE
.SS How to Clean Up Zombies
.RS
.IP \(bu 2
.B Cannot kill zombie directly
\\- already dead
.IP \(bu 2
.B Kill parent process
\\- forces parent to exit, init adopts zombie
.IP \(bu 2
.B Init process (PID 1)
\\- automatically reaps adopted zombies
.IP \(bu 2
.B Fix parent process
\\- proper wait() handling
.IP \(bu 2
.B killzombies kills parent
\\- triggers cleanup via init
.RE
.SH PROCESS IDENTIFICATION
How killzombies identifies processes:
.SS PS Command Chain
.RS
Complete detection pipeline:
.EX
ps ax                      # List all processes
  | awk '{print $1}'       # Extract PIDs
  | grep -v "PID"          # Remove header
  | xargs -n 1 ps lOp      # Long format for each PID
  | grep -v "UID"          # Remove header
  | awk '{print...}'       # Format output
  | grep ": Z"             # Filter zombies
.EE
.IP \(bu 2
Batch processing of all PIDs
.IP \(bu 2
Detailed status for each process
.IP \(bu 2
Filtering by status code
.IP \(bu 2
Extraction of parent PID
.RE
.SS AWK Field Extraction
.RS
Field mapping from ps lOp output:
.IP \(bu 2
Field 3: Process ID (PID)
.IP \(bu 2
Field 4: Parent Process ID (PPID)
.IP \(bu 2
Field 10: Process status (Z for zombie)
.IP \(bu 2
Field 13: Command name
.RE
.SH EXAMPLES
.TP
.B killzombies admin
Interactive zombie detection and killing with confirmation
.TP
.B killzombies cron
Automated zombie cleanup (for cron jobs)
.TP
.B killzombies
Show usage message
.TP
.B 0 */6 * * * killzombies cron
Cron job: run every 6 hours
.TP
.B 0 0 * * * killzombies cron
Cron job: run daily at midnight
.SH FILES
.TP
.B ~/.config/myscripts/killzombies/settings.conf
User configuration file
.TP
.B ~/.local/share/myscripts/killzombies/backups/
Configuration backup directory
.TP
.B ~/.local/log/killzombies/
Log file directory
.TP
.B ~/.local/log/killzombies/kill.log
Automated cleanup log (cron mode)
.TP
.B ~/.local/tmp/system_scripts/killzombies/
Temporary files directory
.TP
.B ~/.cache/killzombies/
Cache directory
.SH ENVIRONMENT VARIABLES
.TP
.B KILLZOMBIES_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.TP
.B KILLZOMBIES_SILENT
Suppress all notifications when set to "true"
.TP
.B SEND_NOTIFICATION
Runtime notification control (set to "no" to disable)
.TP
.B KILLZOMBIES_NOTIFY_CLIENT_NAME
Application name for notifications (default: killzombies)
.TP
.B KILLZOMBIES_NOTIFY_CLIENT_ICON
Icon for notifications (default: notification-new)
.TP
.B KILLZOMBIES_NOTIFY_CLIENT_URGENCY
Notification urgency level (default: normal)
.TP
.B KILLZOMBIES_GOOD_NAME
Success notification title (default: Great:)
.TP
.B KILLZOMBIES_ERROR_NAME
Error notification title (default: Error:)
.TP
.B KILLZOMBIES_GOOD_MESSAGE
Success message text (default: No errors reported)
.TP
.B KILLZOMBIES_ERROR_MESSAGE
Error message text (default: Errors were reported)
.TP
.B KILLZOMBIES_OUTPUT_COLOR_1
Primary output color code (default: 33 for yellow)
.TP
.B KILLZOMBIES_OUTPUT_COLOR_2
Secondary output color code (default: 5 for magenta)
.TP
.B KILLZOMBIES_OUTPUT_COLOR_GOOD
Success message color (default: 2 for green)
.TP
.B KILLZOMBIES_OUTPUT_COLOR_ERROR
Error message color (default: 1 for red)
.SH CONFIGURATION FILE
The configuration file located at ~/.config/myscripts/killzombies/settings.conf supports the following settings:
.PP
.RS 4
.EX
# Notification settings
KILLZOMBIES_NOTIFY_ENABLED="yes"
KILLZOMBIES_GOOD_NAME="Great:"
KILLZOMBIES_ERROR_NAME="Error:"
KILLZOMBIES_GOOD_MESSAGE="No errors reported"
KILLZOMBIES_ERROR_MESSAGE="Errors were reported"
KILLZOMBIES_NOTIFY_CLIENT_NAME="killzombies"
KILLZOMBIES_NOTIFY_CLIENT_ICON="notification-new"
KILLZOMBIES_NOTIFY_CLIENT_URGENCY="normal"

# Output colorization
KILLZOMBIES_OUTPUT_COLOR_1="33"
KILLZOMBIES_OUTPUT_COLOR_2="5"
KILLZOMBIES_OUTPUT_COLOR_GOOD="2"
KILLZOMBIES_OUTPUT_COLOR_ERROR="1"
.EE
.RE
.SH EXIT STATUS
.TP
.B 0
Success - operation completed (zombies killed or none found)
.TP
.B 1
Error - operation failed
.SH NOTES
.IP \(bu 2
Zombies cannot be killed directly (already dead)
.IP \(bu 2
Parent process must be killed to clean up zombies
.IP \(bu 2
Uses SIGKILL (-9) on parent processes
.IP \(bu 2
Admin mode requires user confirmation
.IP \(bu 2
Cron mode operates automatically (no interaction)
.IP \(bu 2
Logs automated cleanups to kill.log
.IP \(bu 2
Init process (PID 1) adopts orphaned zombies
.IP \(bu 2
May require root for system-wide cleanup
.SH TIPS
.SS Cron Configuration
.RS
.EX
# Add to crontab (crontab -e)

# Every 6 hours
0 */6 * * * killzombies cron

# Daily at midnight
0 0 * * * killzombies cron

# Every 30 minutes
*/30 * * * * killzombies cron

# Weekly on Sunday at 2am
0 2 * * 0 killzombies cron
.EE
.RE
.SS Manual Zombie Detection
.RS
.EX
# Find zombies manually
ps aux | awk '$8=="Z" {print}'

# Count zombies
ps aux | awk '$8=="Z"' | wc -l

# Show zombie details
ps lax | awk '$10=="Z"'
.EE
.RE
.SS Identify Problem Parents
.RS
.EX
# Use admin mode to see parent PIDs
killzombies admin

# Check specific parent process
ps -p PARENT_PID -o comm=

# Monitor parent process
watch -n 5 'ps lax | awk "$10==\"Z\""'
.EE
.RE
.SS Prevention
.RS
.EX
# In your code (C example)
#include <signal.h>
#include <sys/wait.h>

void sigchld_handler(int signo) {
    while(waitpid(-1, NULL, WNOHANG) > 0);
}

signal(SIGCHLD, sigchld_handler);
.EE
.RE
.SH USE CASES
.SS Server Maintenance
.RS
.IP \(bu 2
Automated zombie cleanup via cron
.IP \(bu 2
Prevent zombie accumulation
.IP \(bu 2
System health monitoring
.IP \(bu 2
Reduce process table clutter
.RE
.SS Development & Debugging
.RS
.IP \(bu 2
Identify buggy parent processes
.IP \(bu 2
Test process management code
.IP \(bu 2
Debug SIGCHLD handling
.IP \(bu 2
Clean up after testing
.RE
.SS System Administration
.RS
.IP \(bu 2
Interactive zombie management
.IP \(bu 2
Periodic system cleanup
.IP \(bu 2
Troubleshoot process issues
.IP \(bu 2
Maintain system health
.RE
.SH TROUBLESHOOTING
.SS Zombies Keep Reappearing
.RS
.IP \(bu 2
Parent process is buggy (not calling wait())
.IP \(bu 2
Fix parent process code
.IP \(bu 2
Kill parent permanently if necessary
.IP \(bu 2
Restart service with proper configuration
.IP \(bu 2
Check application logs for errors
.RE
.SS Permission Denied
.RS
If cannot kill parent processes:
.IP \(bu 2
Run as root: sudo killzombies admin
.IP \(bu 2
Check process ownership
.IP \(bu 2
Verify parent PID belongs to you
.IP \(bu 2
System processes require root access
.RE
.SS No Zombies Found But They Exist
.RS
If manual ps shows zombies:
.IP \(bu 2
Check ps command output format
.IP \(bu 2
Verify awk field numbers
.IP \(bu 2
Run with --debug to see full output
.IP \(bu 2
Different ps implementations vary
.RE
.SS Cron Job Not Working
.RS
If automated cleanup fails:
.IP \(bu 2
Check cron daemon is running
.IP \(bu 2
Verify crontab syntax: crontab -l
.IP \(bu 2
Check log file for entries
.IP \(bu 2
Ensure full path in crontab
.IP \(bu 2
Test manually: killzombies cron
.RE
.SH COMPARISON TO OTHER TOOLS
.SS vs Manual ps + kill
.RS
.IP \(bu 2
.B killzombies:
Automated zombie detection and killing
.IP \(bu 2
.B Manual:
Requires multi-step ps/grep/kill chain
.IP \(bu 2
killzombies handles parent PID extraction
.IP \(bu 2
Manual requires understanding of process status
.RE
.SS vs pkill/killall
.RS
.IP \(bu 2
.B killzombies:
Targets zombie-specific cleanup
.IP \(bu 2
.B pkill/killall:
General process killing by name
.IP \(bu 2
killzombies kills parent processes
.IP \(bu 2
pkill/killall kill target process directly
.RE
.SH SECURITY NOTES
.IP \(bu 2
Uses SIGKILL (-9) - no graceful shutdown
.IP \(bu 2
Kills parent processes (may affect running services)
.IP \(bu 2
Admin mode requires confirmation for safety
.IP \(bu 2
Cron mode automatic (use with caution)
.IP \(bu 2
May require root for system-wide cleanup
.IP \(bu 2
Test in non-production first
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \(bu 2
bash - Bash shell for script execution
.IP \(bu 2
ps - Process status command
.IP \(bu 2
awk - Text processing for field extraction
.IP \(bu 2
grep - Pattern matching for status filtering
.IP \(bu 2
xargs - Batch command execution
.IP \(bu 2
kill - Process termination command
.RE
.TP
.B Optional:
.RS
.IP \(bu 2
notifications - Desktop notification system
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \(co 2022 Jason Hempstead, Casjays Developments
.br
License: WTFPL (Do What The F*** You Want To Public License)
.SH SEE ALSO
.BR ps (1),
.BR kill (1),
.BR wait (2),
.BR waitpid (2),
.BR signal (7)
