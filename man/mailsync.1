.TH MAILSYNC "1" "December 2025" "mailsync 202208122213-git" "User Commands"
.SH NAME
mailsync \- Sync mail and give notification if there is new mail
.SH SYNOPSIS
.B mailsync
[\fI\,OPTIONS\/\fR] [\fI\,ACCOUNT\/\fR...]
.SH DESCRIPTION
.B mailsync
is an automated email synchronization tool that uses mbsync (isync) to fetch mail from remote servers and provides desktop notifications when new mail arrives. It integrates with notmuch for mail indexing and supports multiple email accounts with parallel synchronization.
.PP
The script simplifies email management by providing automatic mail synchronization using mbsync/isync, desktop notifications for new mail with sender and subject display, notmuch integration for mail indexing and searching, parallel account synchronization for efficiency, status bar integration for display updates, pass (password store) integration for secure credential storage, duplicate instance prevention to avoid conflicts, user login verification before sync, and comprehensive error handling.
.PP
mailsync is particularly useful for automated mail retrieval with cron jobs or timers, email client backend for mutt, neomutt, or aerc, new mail notification system for status bars, multi-account email synchronization, and offline mail access with local caching.
.SH COMMANDS
.TP
.B mailsync
Sync all accounts defined in ~/.mbsyncrc
.TP
.B mailsync \fI\,account1 account2\/\fR
Sync only specified accounts
.SH OPTIONS
.TP
.BR \-\-dir " " \fI\,DIRECTORY\/\fR
Set working directory before synchronization
.TP
.BR \-\-silent
Suppress notification output
.TP
.BR \-\-help
Display help message with usage information and exit
.TP
.BR \-\-config
Generate or regenerate user configuration file and exit
.TP
.BR \-\-version
Show script version information and exit
.TP
.BR \-\-options
Display all available command-line options and exit
.TP
.BR \-\-debug
Enable debug mode with verbose output and tracing
.TP
.BR \-\-raw
Disable colorized output for plain text display
.TP
.BR \-\-completions " " \fI\,TYPE\/\fR
Generate completion strings for shell integration (short, long, array, list)
.SH HOW IT WORKS
mailsync operates through several key components:
.SS Mail Synchronization
.RS
The script uses mbsync (isync) to synchronize mail from remote IMAP servers to local Maildir directories. Mail is stored in ~/.local/share/mail/<account>/INBOX/new/ (or inbox/new/ or Inbox/new/ depending on configuration).
.PP
Process:
.IP 1. 3
Check if mbsync is already running (prevent duplicates)
.IP 2. 3
Verify user is logged in
.IP 3. 3
Read account configuration from ~/.mbsyncrc
.IP 4. 3
Update status bar indicator (ðŸ”ƒ) if STATUSBAR variable set
.IP 5. 3
Synchronize each account in parallel
.IP 6. 3
Run notmuch to index new mail
.IP 7. 3
Update last run timestamp
.RE
.SS New Mail Detection
.RS
After synchronizing each account, mailsync scans the new mail directory for messages that are newer than the last run timestamp. For each new message:
.IP 1. 3
Count total new messages
.IP 2. 3
Send notification with account name and count
.IP 3. 3
Extract From: and Subject: headers from each message
.IP 4. 3
Decode MIME-encoded headers
.IP 5. 3
Send individual notifications for each new mail
.RE
.SS Notification System
.RS
Desktop notifications are sent using the notifications command (if available). Each notification includes:
.IP \(bu 2
Account-level notification: "ðŸ“¬ N new mail(s) in `account` account."
.IP \(bu 2
Message-level notifications: "ðŸ“§<sender>: <subject>"
.PP
Notifications run in background and don't block synchronization.
.RE
.SS Password Management
.RS
mailsync requires pass (password store) for secure credential storage. Credentials are stored in:
.IP \(bu 2
PASSWORD_STORE_DIR (if set globally)
.IP \(bu 2
MAILSYNC_PASSWORD_STORE_DIR (script-specific)
.IP \(bu 2
~/.local/share/pass-store (default)
.PP
mbsync retrieves passwords from pass during synchronization.
.RE
.SH CONFIGURATION
.SS ~/.mbsyncrc
This is the main configuration file for mbsync that defines email accounts and synchronization settings:
.PP
.RS 4
.EX
# Gmail Account
IMAPAccount gmail
Host imap.gmail.com
User yourname@gmail.com
PassCmd "pass email/gmail"
SSLType IMAPS
AuthMechs LOGIN

IMAPStore gmail-remote
Account gmail

MaildirStore gmail-local
Path ~/.local/share/mail/gmail/
Inbox ~/.local/share/mail/gmail/INBOX
SubFolders Verbatim

Channel gmail
Far :gmail-remote:
Near :gmail-local:
Patterns *
Create Near
Sync All
Expunge Both
SyncState *

# Work Account
IMAPAccount work
Host mail.company.com
User username@company.com
PassCmd "pass email/work"
SSLType IMAPS

IMAPStore work-remote
Account work

MaildirStore work-local
Path ~/.local/share/mail/work/
Inbox ~/.local/share/mail/work/INBOX

Channel work
Far :work-remote:
Near :work-local:
Patterns *
Sync All
.EE
.RE
.PP
Key Configuration Elements:
.IP \(bu 2
.B IMAPAccount
- Defines remote server connection
.IP \(bu 2
.B PassCmd
- Command to retrieve password from pass
.IP \(bu 2
.B Channel
- Links remote and local stores
.IP \(bu 2
.B Patterns
- Folders to synchronize (* = all)
.IP \(bu 2
.B Sync All
- Synchronize flags, new, and deleted messages
.SS ~/.config/myscripts/mailsync/settings.conf
mailsync configuration file:
.PP
.RS 4
.EX
# Settings for mailsync
MAILSYNC_PASSWORD_STORE_DIR="$HOME/.local/share/pass-store"

# Color Settings
MAILSYNC_OUTPUT_COLOR_1="33"
MAILSYNC_OUTPUT_COLOR_2="5"
MAILSYNC_OUTPUT_COLOR_GOOD="2"
MAILSYNC_OUTPUT_COLOR_ERROR="1"

# Notification Settings
MAILSYNC_NOTIFY_ENABLED="yes"
MAILSYNC_GOOD_NAME="Great:"
MAILSYNC_ERROR_NAME="Error:"
MAILSYNC_GOOD_MESSAGE="No errors reported"
MAILSYNC_ERROR_MESSAGE="Errors were reported"
MAILSYNC_NOTIFY_CLIENT_NAME="mailsync"
MAILSYNC_NOTIFY_CLIENT_ICON="notification-new"
MAILSYNC_NOTIFY_CLIENT_URGENCY="normal"
.EE
.RE
.SH EXAMPLES
.TP
.B mailsync
Synchronize all accounts defined in ~/.mbsyncrc
.TP
.B mailsync gmail
Synchronize only the gmail account
.TP
.B mailsync gmail work
Synchronize gmail and work accounts
.TP
.B mailsync --silent
Synchronize all accounts without notifications
.TP
.B mailsync --config
Generate configuration file at ~/.config/myscripts/mailsync/settings.conf
.SH USE CASES
How to use mailsync in different scenarios:
.SS Cron Job Automation
.RS
Set up automatic mail synchronization with cron:
.PP
.EX
# Edit crontab
crontab -e

# Sync mail every 5 minutes
*/5 * * * * mailsync >/dev/null 2>&1

# Sync mail every 15 minutes (less frequent)
*/15 * * * * mailsync

# Sync only during work hours (9am-6pm)
*/10 9-18 * * 1-5 mailsync
.EE
.PP
Important for cron:
.IP \(bu 2
Set DISPLAY and DBUS_SESSION_BUS_ADDRESS for notifications
.IP \(bu 2
Ensure PATH includes mbsync and notmuch
.IP \(bu 2
Redirect output to avoid cron emails
.RE
.SS Systemd Timer
.RS
Create automated synchronization with systemd timer:
.PP
.EX
# ~/.config/systemd/user/mailsync.service
[Unit]
Description=Mailbox synchronization service

[Service]
Type=oneshot
ExecStart=/usr/local/bin/mailsync

# ~/.config/systemd/user/mailsync.timer
[Unit]
Description=Mailbox synchronization timer

[Timer]
OnBootSec=2m
OnUnitActiveSec=5m

[Install]
WantedBy=timers.target

# Enable and start timer
systemctl --user enable mailsync.timer
systemctl --user start mailsync.timer

# Check status
systemctl --user status mailsync.timer
systemctl --user list-timers
.EE
.RE
.SS Status Bar Integration
.RS
Integrate with status bar (i3blocks, polybar, dwmblocks):
.PP
.EX
# i3blocks configuration
[mail]
command=mailsync && mu find --nocolor maildir:/*/INBOX flag:unread | wc -l
interval=300
signal=12

# dwmblocks configuration
static const Block blocks[] = {
    {"", "mailsync && mu find maildir:/*/INBOX flag:unread | wc -l", 300, 12},
};

# Status bar update after sync
STATUSBAR="dwmblocks" mailsync
# Sends RTMIN+12 signal to update status bar
.EE
.RE
.SS Mutt Integration
.RS
Integrate with mutt email client:
.PP
.EX
# ~/.muttrc
# Pre-sync hook
folder-hook . 'macro index,pager gs "<shell-escape>mailsync<enter>" "Sync mail"'

# Automatic sync on mailbox change
folder-hook . 'push <sync-mailbox>'

# Bind key to sync
macro index,pager S "<shell-escape>mailsync<enter>" "Sync mail"

# Check for new mail
set mail_check = 60
set timeout = 10
.EE
.RE
.SS Account-Specific Sync
.RS
Synchronize specific accounts based on context:
.PP
.EX
# Work hours - sync work account only
if [ $(date +%H) -ge 9 ] && [ $(date +%H) -lt 18 ]; then
    mailsync work
else
    mailsync personal
fi

# Location-based sync
if nmcli -t -f NAME connection show --active | grep -q "Company-WiFi"; then
    mailsync work
else
    mailsync personal
fi

# Network-based sync
if ping -c1 mail.company.com &>/dev/null; then
    mailsync work personal
else
    mailsync personal
fi
.EE
.RE
.SS Notification Filtering
.RS
Filter notifications by sender or subject:
.PP
.EX
# Modify syncandnotify function
syncandnotify() {
    acc="$(echo "$account" | sed "s/.*\\///")"
    mbsync "$acc"

    # Filter: only notify for important senders
    new=$(find "$HOME/.local/share/mail/$acc/INBOX/new/" -type f -newer "$MAILSYNC_CACHE_DIR/mailsynclastrun" 2>/dev/null)

    for file in $new; do
        from=$(awk '/^From: / && ++n ==1,/^\\<.*\\>:/' "$file" | grep -o '<.*>' | tr -d '<>')

        # Only notify for specific domains
        if echo "$from" | grep -q '@important\\.com\\|@urgent\\.org'; then
            subject=$(awk '/^Subject: /' "$file")
            __notify "ðŸ“§$from:" "$subject" &
        fi
    done
}
.EE
.RE
.SH HEADER DECODING
mailsync decodes MIME-encoded email headers for proper display:
.SS MIME Header Encoding
.RS
Email headers with non-ASCII characters are encoded:
.PP
.EX
# Original subject
Subject: Meeting RÃ©union ä¼šè­°

# MIME-encoded (quoted-printable)
Subject: =?UTF-8?Q?Meeting_R=C3=A9union_=E4=BC=9A=E8=AD=B0?=

# MIME-encoded (base64)
Subject: =?UTF-8?B?TWVldGluZyBSw6l1bmlvbiDkvJrop7o=?=
.EE
.RE
.SS Decoding Process
.RS
mailsync uses Perl's Encode module to decode:
.PP
.EX
# From header extraction and decoding
from=$(awk '/^From: / && ++n ==1,/^\\<.*\\>:/' "$file" \\
    | perl -CS -MEncode -ne 'print decode("MIME-Header", $_)' \\
    | awk '{ $1=""; if (NF>=3)$NF=""; print $0 }' \\
    | sed 's/^[[:blank:]]*[\\"'\\''\\<]*//;s/[\\"'\\''\\>]*[[:blank:]]*$//')

# Subject header extraction and decoding
subject=$(awk '/^Subject: / && ++n == 1,/^\\<.*\\>: / && ++i == 2' "$file" \\
    | head -n-1 \\
    | perl -CS -MEncode -ne 'print decode("MIME-Header", $_)' \\
    | sed 's/^Subject: //' \\
    | sed 's/^{[[:blank:]]*[\\"'\\''\\<]*//;s/[\\"'\\''\\>]*[[:blank:]]*$//' \\
    | tr -d '\\n')
.EE
.PP
Steps:
.IP 1. 3
Extract header lines with awk
.IP 2. 3
Decode MIME encoding with Perl Encode::decode()
.IP 3. 3
Strip quotes, brackets, and whitespace with sed
.IP 4. 3
Remove newlines for single-line display
.RE
.SH FILES
.TP
.B ~/.mbsyncrc
mbsync/isync configuration file defining accounts and sync settings
.TP
.B ~/.config/myscripts/mailsync/settings.conf
User configuration file for mailsync
.TP
.B ~/.local/share/myscripts/mailsync/backups/
Configuration backup directory
.TP
.B ~/.local/log/mailsync/
Log file directory
.TP
.B ~/.local/tmp/system_scripts/mailsync/
Temporary files directory (status indicator storage)
.TP
.B ~/.cache/mailsync/
Cache directory
.TP
.B ~/.cache/mailsync/mailsynclastrun
Timestamp file for tracking last synchronization run
.TP
.B ~/.local/share/mail/
Default Maildir storage location for synchronized mail
.TP
.B ~/.local/share/mail/<account>/INBOX/new/
New mail directory for each account
.TP
.B ~/.local/share/pass-store/
Default password store directory (configurable)
.SH ENVIRONMENT VARIABLES
.TP
.B PASSWORD_STORE_DIR
Global password store directory (overrides MAILSYNC_PASSWORD_STORE_DIR)
.TP
.B MAILSYNC_PASSWORD_STORE_DIR
Script-specific password store directory (default: ~/.local/share/pass-store)
.TP
.B DBUS_SESSION_BUS_ADDRESS
D-Bus session address for desktop notifications (default: unix:path=/run/user/$(id -u)/bus)
.TP
.B STATUSBAR
Status bar program to signal after sync (e.g., dwmblocks, i3blocks)
.TP
.B SEND_NOTIFICATION
Runtime notification control (set to "no" to disable)
.TP
.B MAILSYNC_NOTIFY_ENABLED
Enable/disable desktop notifications (default: yes)
.TP
.B MAILSYNC_NOTIFY_CLIENT_NAME
Application name for notifications (default: mailsync)
.TP
.B MAILSYNC_NOTIFY_CLIENT_ICON
Icon for notifications (default: notification-new)
.TP
.B MAILSYNC_NOTIFY_CLIENT_URGENCY
Notification urgency level (default: normal)
.TP
.B MAILSYNC_GOOD_NAME
Success notification title (default: Great:)
.TP
.B MAILSYNC_ERROR_NAME
Error notification title (default: Error:)
.TP
.B MAILSYNC_GOOD_MESSAGE
Success message text (default: No errors reported)
.TP
.B MAILSYNC_ERROR_MESSAGE
Error message text (default: Errors were reported)
.TP
.B MAILSYNC_OUTPUT_COLOR_1
Primary output color code (default: 33 for yellow)
.TP
.B MAILSYNC_OUTPUT_COLOR_2
Secondary output color code (default: 5 for magenta)
.TP
.B MAILSYNC_OUTPUT_COLOR_GOOD
Success message color (default: 2 for green)
.TP
.B MAILSYNC_OUTPUT_COLOR_ERROR
Error message color (default: 1 for red)
.SH EXIT STATUS
.TP
.B 0
Success - mail synchronized successfully
.TP
.B 1
General error - configuration or runtime error
.TP
.B 2
Sudo error - script requires sudo but user cannot sudo (if MAILSYNC_REQUIRE_SUDO=yes)
.TP
.B 3
Dependency error - required command not found (bash, mbsync, notmuch)
.TP
.B 4
Network error - no internet connection (if online check enabled)
.SH DEPENDENCIES
.TP
.B Required:
.RS
.IP \(bu 2
bash - Bash shell for script execution
.IP \(bu 2
mbsync (isync) - Mail synchronization tool (package: isync)
.IP \(bu 2
notmuch - Mail indexer and search tool
.IP \(bu 2
pass - Unix password manager (password-store)
.IP \(bu 2
awk - Text processing
.IP \(bu 2
sed - Stream editor
.IP \(bu 2
grep - Pattern matching
.IP \(bu 2
find - File search utility
.IP \(bu 2
perl - Perl interpreter with Encode module
.RE
.TP
.B Optional:
.RS
.IP \(bu 2
notifications - Desktop notification system (for new mail alerts)
.IP \(bu 2
mu (maildir-utils) - Alternative mail indexer
.IP \(bu 2
gpg - GPG for encrypted password storage with pass
.RE
.SH NOTES
.IP \(bu 2
Script prevents duplicate instances by checking for running mbsync process
.IP \(bu 2
Requires user to be logged in (checks with pgrep)
.IP \(bu 2
Accounts are synchronized in parallel for efficiency
.IP \(bu 2
New mail detection compares timestamps with last run
.IP \(bu 2
MIME header decoding supports UTF-8 and various encodings
.IP \(bu 2
Status bar integration uses RTMIN+12 signal
.IP \(bu 2
Notifications run in background to avoid blocking
.IP \(bu 2
Pass password store must be initialized before first use
.IP \(bu 2
Works with any mbsync-compatible email provider
.IP \(bu 2
Mail stored in Maildir format for compatibility
.SH TIPS
.SS Initial Setup
.RS
Set up mailsync for the first time:
.PP
.EX
# 1. Install dependencies
# Debian/Ubuntu:
sudo apt install isync notmuch pass

# Fedora/RHEL:
sudo dnf install isync notmuch pass

# Arch:
sudo pacman -S isync notmuch pass

# 2. Initialize pass
gpg --full-generate-key  # Generate GPG key if needed
pass init "your@email.com"

# 3. Store email passwords
pass insert email/gmail
pass insert email/work

# 4. Create ~/.mbsyncrc configuration (see CONFIGURATION section)

# 5. Test mbsync directly
mbsync -V gmail  # Verbose sync for testing

# 6. Initialize notmuch
notmuch setup

# 7. Generate mailsync config
mailsync --config

# 8. Run first sync
mailsync

# 9. Set up automated sync (cron or systemd timer)
.EE
.RE
.SS Multiple Inbox Names
.RS
Handle different INBOX naming conventions:
.PP
.EX
# Script checks three common names:
# 1. INBOX (standard)
# 2. Inbox (some servers)
# 3. inbox (lowercase)

# Configure mbsync to use consistent naming:
MaildirStore account-local
Path ~/.local/share/mail/account/
Inbox ~/.local/share/mail/account/INBOX  # Force uppercase

# Or use SubFolders setting:
SubFolders Verbatim  # Keep server folder names
.EE
.RE
.SS Notification Customization
.RS
Customize notification appearance and behavior:
.PP
.EX
# ~/.config/myscripts/mailsync/settings.conf

# Use different urgency levels
MAILSYNC_NOTIFY_CLIENT_URGENCY="critical"  # For important mail
MAILSYNC_NOTIFY_CLIENT_URGENCY="low"       # For less important

# Custom icons
MAILSYNC_NOTIFY_CLIENT_ICON="mail-unread"
MAILSYNC_NOTIFY_CLIENT_ICON="emblem-mail"

# Disable notifications entirely
MAILSYNC_NOTIFY_ENABLED="no"

# Runtime disable
SEND_NOTIFICATION="no" mailsync
.EE
.RE
.SS Performance Optimization
.RS
Optimize sync performance:
.PP
.EX
# ~/.mbsyncrc optimizations

# Limit initial sync
MaxMessages 1000  # Only sync recent messages

# Parallel channel sync
Sync Pull  # Only download (faster for large mailboxes)
Sync New   # Only fetch new messages

# Connection timeout
Timeout 60

# Pipeline for speed
PipelineDepth 50

# Compress data transfer
UseIMAPS yes
TLSType IMAPS
.EE
.RE
.SS Troubleshooting Sync Issues
.RS
Debug synchronization problems:
.PP
.EX
# Run mbsync directly with verbose output
mbsync -V -D all gmail

# Check mailsync in debug mode
mailsync --debug

# Check for running instances
pgrep -a mbsync
ps aux | grep mbsync

# Kill stuck mbsync processes
pkill mbsync

# Check notmuch status
notmuch new --verbose

# Verify mail directories
ls -la ~/.local/share/mail/*/INBOX/new/

# Check pass access
pass email/gmail
.EE
.RE
.SH TROUBLESHOOTING
.SS mbsync Already Running
.RS
Error: "mbsync is already running."
.PP
Solution:
.IP \(bu 2
Wait for current sync to complete
.IP \(bu 2
Check for stuck process: pgrep -a mbsync
.IP \(bu 2
Kill stuck process: pkill mbsync
.IP \(bu 2
Remove lock files: rm ~/.local/share/mail/*/.mbsyncstate.lock
.RE
.SS User Not Logged In
.RS
Error: "$USER not logged in; sync will not run."
.PP
Solution:
.IP \(bu 2
Ensure user has active session: pgrep -u $USER
.IP \(bu 2
For cron/systemd: Use lingering: loginctl enable-linger $USER
.IP \(bu 2
Check D-Bus session: echo $DBUS_SESSION_BUS_ADDRESS
.RE
.SS Pass Program Not Configured
.RS
Error: "This requires the pass program to be install and configured"
.PP
Solution:
.IP \(bu 2
Install pass: sudo apt install pass
.IP \(bu 2
Generate GPG key: gpg --full-generate-key
.IP \(bu 2
Initialize pass: pass init "your@email.com"
.IP \(bu 2
Store password: pass insert email/account
.IP \(bu 2
Test retrieval: pass email/account
.IP \(bu 2
Set PASSWORD_STORE_DIR if using custom location
.RE
.SS No New Mail Notifications
.RS
If notifications don't appear:
.PP
Solution:
.IP \(bu 2
Check notifications installed: which notifications
.IP \(bu 2
Test notification: notify-send "Test" "Message"
.IP \(bu 2
Verify DBUS_SESSION_BUS_ADDRESS set
.IP \(bu 2
Check MAILSYNC_NOTIFY_ENABLED="yes"
.IP \(bu 2
Ensure SEND_NOTIFICATION not set to "no"
.IP \(bu 2
Run mailsync without --silent
.IP \(bu 2
Check notification daemon running: pgrep -a dunst || pgrep -a notification-daemon
.RE
.SS mbsync Connection Errors
.RS
If mbsync cannot connect:
.PP
Solution:
.IP \(bu 2
Test connection: telnet imap.gmail.com 993
.IP \(bu 2
Check credentials: pass email/account
.IP \(bu 2
Verify ~/.mbsyncrc syntax: mbsync -V -D all account
.IP \(bu 2
Check firewall: sudo iptables -L
.IP \(bu 2
Try different port: Port 143 with STARTTLS
.IP \(bu 2
Enable app passwords for Gmail (not regular password)
.IP \(bu 2
Check server status: ping imap.gmail.com
.RE
.SS Notmuch Errors
.RS
If notmuch indexing fails:
.PP
Solution:
.IP \(bu 2
Initialize database: notmuch setup
.IP \(bu 2
Rebuild index: notmuch new --full-scan
.IP \(bu 2
Check database: notmuch count '*'
.IP \(bu 2
Fix permissions: chmod -R u+rwX ~/.local/share/mail/
.IP \(bu 2
Verify mail directory in notmuch config
.RE
.SH SECURITY CONSIDERATIONS
.SS Password Storage
.RS
.IP \(bu 2
Never store passwords in plain text in ~/.mbsyncrc
.IP \(bu 2
Always use PassCmd with pass password manager
.IP \(bu 2
Ensure GPG key is protected with strong passphrase
.IP \(bu 2
Set appropriate permissions: chmod 600 ~/.mbsyncrc
.IP \(bu 2
Use app-specific passwords for Gmail/Google accounts
.RE
.SS Credential Caching
.RS
.IP \(bu 2
Pass caches passwords in GPG agent for session
.IP \(bu 2
Set cache timeout: echo "default-cache-ttl 600" >> ~/.gnupg/gpg-agent.conf
.IP \(bu 2
Clear cache: gpgconf --reload gpg-agent
.RE
.SS Mail Storage
.RS
.IP \(bu 2
Mail stored unencrypted in ~/.local/share/mail/
.IP \(bu 2
Set directory permissions: chmod 700 ~/.local/share/mail/
.IP \(bu 2
Consider encrypting home directory or using full disk encryption
.IP \(bu 2
For sensitive mail, use encrypted filesystem or per-message encryption
.RE
.SH INTEGRATION WITH EMAIL CLIENTS
mailsync works as backend for various email clients:
.SS Mutt/Neomutt
.RS
.EX
# ~/.muttrc
set folder = "~/.local/share/mail"
set spoolfile = "+gmail/INBOX"
set mbox_type = Maildir
set record = "+gmail/Sent"
set postponed = "+gmail/Drafts"

# Multiple accounts
folder-hook gmail/* source ~/.mutt/accounts/gmail
folder-hook work/* source ~/.mutt/accounts/work

# Sync before checking mail
macro index,pager S "<shell-escape>mailsync<enter>" "Sync mail"
.EE
.RE
.SS Aerc
.RS
.EX
# ~/.config/aerc/accounts.conf
[gmail]
source = maildir://~/.local/share/mail/gmail
outgoing = smtp+plain://user@smtp.gmail.com
from = yourname@gmail.com
copy-to = Sent
mailsync-cmd = mailsync gmail
check-mail-cmd = mailsync gmail
check-mail-timeout = 5m
.EE
.RE
.SS Notmuch
.RS
.EX
# ~/.notmuch-config
[database]
path=/home/user/.local/share/mail

[user]
name=Your Name
primary_email=you@example.com

[new]
tags=unread;inbox;
ignore=.mbsyncstate;.uidvalidity

[search]
exclude_tags=deleted;spam;

[maildir]
synchronize_flags=true

# Use notmuch from command line or emacs
notmuch search tag:unread
notmuch show thread:00000000000001234
.EE
.RE
.SH BUGS
Report bugs at: https://github.com/casjay-dotfiles/scripts/issues
.SH AUTHOR
Written by Jason Hempstead (CasjaysDev)
.SH COPYRIGHT
Copyright \(co 2022 Jason Hempstead, Casjays Developments
.br
License: WTFPL (Do What The F*** You Want To Public License)
.SH SEE ALSO
.BR mbsync (1),
.BR isync (1),
.BR notmuch (1),
.BR pass (1),
.BR mutt (1),
.BR neomutt (1),
.BR gpg (1)
